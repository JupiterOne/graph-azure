{
  "log": {
    "_recordingName": "rm-security-defender-alerts",
    "creator": {
      "comment": "persister:JupiterOneIntegationFSPersister",
      "name": "Polly.JS",
      "version": "6.0.5"
    },
    "entries": [
      {
        "_id": "419f8a68424a58ccfbfa7e96d080076d",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 182,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "content-type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "content-length",
              "value": "182"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "login.microsoftonline.com"
            }
          ],
          "headersSize": 340,
          "httpVersion": "HTTP/1.1",
          "method": "POST",
          "postData": {
            "mimeType": "application/x-www-form-urlencoded",
            "params": [],
            "text": "[REDACTED]"
          },
          "queryString": [],
          "url": "https://login.microsoftonline.com/directory-id/oauth2/v2.0/token"
        },
        "response": {
          "bodySize": 1772,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 1772,
            "text": "{\"token_type\":\"Bearer\",\"expires_in\":3599,\"ext_expires_in\":3599,\"access_token\":\"[REDACTED]\"}"
          },
          "cookies": [
            {
              "expires": "2024-05-05T17:35:43.000Z",
              "httpOnly": true,
              "name": "fpc",
              "path": "/",
              "sameSite": "None",
              "secure": true,
              "value": "[REDACTED]"
            },
            {
              "httpOnly": true,
              "name": "x-ms-gateway-slice",
              "path": "/",
              "sameSite": "none",
              "secure": true,
              "value": "[REDACTED]"
            },
            {
              "httpOnly": true,
              "name": "stsservicecookie",
              "path": "/",
              "sameSite": "none",
              "secure": true,
              "value": "[REDACTED]"
            }
          ],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-store, no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "p3p",
              "value": "CP=\"DSP CUR OTPi IND OTRi ONL FIN\""
            },
            {
              "name": "x-ms-request-id",
              "value": "a052f3a8-da8e-4cfa-b32e-d066f0963e00"
            },
            {
              "name": "x-ms-ests-server",
              "value": "2.1.17750.6 - WUS3 ProdSlices"
            },
            {
              "name": "x-ms-srs",
              "value": "1.P"
            },
            {
              "name": "x-xss-protection",
              "value": "0"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:42 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            },
            {
              "name": "content-length",
              "value": "1772"
            }
          ],
          "headersSize": 771,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:42.705Z",
        "time": 536,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 536
        }
      },
      {
        "_id": "39cb0d299503e6ab1f6a07ceece09c83",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "authorization",
              "value": "[REDACTED]"
            },
            {
              "_fromType": "array",
              "name": "client-request-id",
              "value": "cc8e8598-e559-6caa-2d1e-e0f128caab07"
            },
            {
              "_fromType": "array",
              "name": "sdkversion",
              "value": "graph-js/2.0.0 (featureUsage=7)"
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "graph.microsoft.com"
            }
          ],
          "headersSize": 2037,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [],
          "url": "https://graph.microsoft.com/v1.0/organization"
        },
        "response": {
          "bodySize": 974,
          "content": {
            "mimeType": "application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8",
            "size": 974,
            "text": "{\"@odata.context\":\"https://graph.microsoft.com/v1.0/$metadata#organization\",\"value\":[{\"id\":\"directory-id\",\"deletedDateTime\":null,\"businessPhones\":[],\"city\":null,\"country\":null,\"countryLetterCode\":\"US\",\"createdDateTime\":\"2021-09-01T14:59:04Z\",\"defaultUsageLocation\":null,\"displayName\":\"JupiterOne Azure Integration Development\",\"isMultipleDataLocationsForServicesEnabled\":null,\"marketingNotificationEmails\":[],\"onPremisesLastSyncDateTime\":null,\"onPremisesSyncEnabled\":null,\"partnerTenantType\":null,\"postalCode\":null,\"preferredLanguage\":\"en\",\"securityComplianceNotificationMails\":[],\"securityComplianceNotificationPhones\":[],\"state\":null,\"street\":null,\"technicalNotificationMails\":[\"dev-integrations@jupiterone.com\"],\"tenantType\":\"AAD\",\"directorySizeQuota\":{\"used\":524,\"total\":50000},\"assignedPlans\":[{\"assignedDateTime\":\"2023-12-15T15:35:49Z\",\"capabilityStatus\":\"Enabled\",\"service\":\"WindowsAzure\",\"servicePlanId\":\"fca3e605-0754-4279-8504-3f1229f29614\"}],\"onPremisesSyncStatus\":[],\"privacyProfile\":{\"contactEmail\":\"\",\"statementUrl\":\"\"},\"provisionedPlans\":[],\"verifiedDomains\":[{\"capabilities\":\"Email, OfficeCommunicationsOnline\",\"isDefault\":true,\"isInitial\":true,\"name\":\"j1AzureIntegrationDev.onmicrosoft.com\",\"type\":\"Managed\"}]}]}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8"
            },
            {
              "name": "vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000"
            },
            {
              "name": "request-id",
              "value": "7a970f9d-3274-4c3e-a76c-81ca4d4927cc"
            },
            {
              "name": "client-request-id",
              "value": "cc8e8598-e559-6caa-2d1e-e0f128caab07"
            },
            {
              "name": "x-ms-ags-diagnostic",
              "value": "{\"ServerInfo\":{\"DataCenter\":\"Brazil South\",\"Slice\":\"E\",\"Ring\":\"3\",\"ScaleUnit\":\"000\",\"RoleInstance\":\"CP1PEPF0000474B\"}}"
            },
            {
              "name": "x-ms-resource-unit",
              "value": "1"
            },
            {
              "name": "odata-version",
              "value": "4.0"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:42 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            }
          ],
          "headersSize": 608,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:43.259Z",
        "time": 434,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 434
        }
      },
      {
        "_id": "21b88abd562de50ac5fa61166c4f8fc1",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "authorization",
              "value": "[REDACTED]"
            },
            {
              "_fromType": "array",
              "name": "client-request-id",
              "value": "4925adce-8408-9acd-1d61-2e99a64421e7"
            },
            {
              "_fromType": "array",
              "name": "sdkversion",
              "value": "graph-js/2.0.0 (featureUsage=7)"
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "graph.microsoft.com"
            }
          ],
          "headersSize": 2075,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [],
          "url": "https://graph.microsoft.com/v1.0/policies/identitySecurityDefaultsEnforcementPolicy"
        },
        "response": {
          "bodySize": 482,
          "content": {
            "mimeType": "application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8",
            "size": 482,
            "text": "{\"@odata.context\":\"https://graph.microsoft.com/v1.0/$metadata#policies/identitySecurityDefaultsEnforcementPolicy/$entity\",\"id\":\"00000000-0000-0000-0000-000000000005\",\"displayName\":\"Security Defaults\",\"description\":\"Security defaults is a set of basic identity security mechanisms recommended by Microsoft. When enabled, these recommendations will be automatically enforced in your organization. Administrators and users will be better protected from common identity related attacks.\",\"isEnabled\":true,\"controlTypes\":[],\"securityDefaultsUpsell\":null}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8"
            },
            {
              "name": "retry-after",
              "value": "1209600"
            },
            {
              "name": "vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000"
            },
            {
              "name": "request-id",
              "value": "9e3043ea-c230-4604-ad4f-acdae4ea39df"
            },
            {
              "name": "client-request-id",
              "value": "4925adce-8408-9acd-1d61-2e99a64421e7"
            },
            {
              "name": "x-ms-ags-diagnostic",
              "value": "{\"ServerInfo\":{\"DataCenter\":\"Brazil South\",\"Slice\":\"E\",\"Ring\":\"3\",\"ScaleUnit\":\"000\",\"RoleInstance\":\"CP1PEPF00006F50\"}}"
            },
            {
              "name": "odata-version",
              "value": "4.0"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:43 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            }
          ],
          "headersSize": 607,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:43.710Z",
        "time": 788,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 788
        }
      },
      {
        "_id": "4eab979841c1f2185e48b484c23ec3e2",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 178,
          "cookies": [],
          "headers": [
            {
              "name": "content-type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "name": "accept-charset",
              "value": "utf-8"
            },
            {
              "name": "client-request-id",
              "value": "cd10588e-d19f-4130-ab9d-2fbde9f6a40c"
            },
            {
              "name": "return-client-request-id",
              "value": "true"
            },
            {
              "name": "x-client-sku",
              "value": "Node"
            },
            {
              "name": "x-client-ver",
              "value": "0.1.28"
            },
            {
              "name": "x-client-os",
              "value": "darwin"
            },
            {
              "name": "x-client-cpu",
              "value": "x64"
            },
            {
              "name": "host",
              "value": "login.microsoftonline.com"
            },
            {
              "name": "content-length",
              "value": 178
            }
          ],
          "headersSize": 414,
          "httpVersion": "HTTP/1.1",
          "method": "POST",
          "postData": {
            "mimeType": "application/x-www-form-urlencoded",
            "params": [],
            "text": "[REDACTED]"
          },
          "queryString": [
            {
              "name": "api-version",
              "value": "1.0"
            }
          ],
          "url": "https://login.microsoftonline.com/directory-id/oauth2/token?api-version=1.0"
        },
        "response": {
          "bodySize": 1468,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 1468,
            "text": "{\"token_type\":\"Bearer\",\"expires_in\":\"3599\",\"ext_expires_in\":\"3599\",\"expires_on\":\"1712342145\",\"not_before\":\"1712338245\",\"resource\":\"https://management.azure.com/\",\"access_token\":\"[REDACTED]\"}"
          },
          "cookies": [
            {
              "expires": "2024-05-05T17:35:45.000Z",
              "httpOnly": true,
              "name": "fpc",
              "path": "/",
              "sameSite": "None",
              "secure": true,
              "value": "[REDACTED]"
            },
            {
              "httpOnly": true,
              "name": "x-ms-gateway-slice",
              "path": "/",
              "secure": true,
              "value": "[REDACTED]"
            },
            {
              "httpOnly": true,
              "name": "stsservicecookie",
              "path": "/",
              "secure": true,
              "value": "[REDACTED]"
            }
          ],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-store, no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "p3p",
              "value": "CP=\"DSP CUR OTPi IND OTRi ONL FIN\""
            },
            {
              "name": "client-request-id",
              "value": "cd10588e-d19f-4130-ab9d-2fbde9f6a40c"
            },
            {
              "name": "x-ms-request-id",
              "value": "0e012674-63f5-4f9c-8634-4ce28bcf0e00"
            },
            {
              "name": "x-ms-ests-server",
              "value": "2.1.17750.6 - SCUS ProdSlices"
            },
            {
              "name": "x-ms-clitelem",
              "value": "1,0,0,,"
            },
            {
              "name": "x-ms-srs",
              "value": "1.P"
            },
            {
              "name": "x-xss-protection",
              "value": "0"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:45 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            },
            {
              "name": "content-length",
              "value": "1468"
            }
          ],
          "headersSize": 822,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:44.612Z",
        "time": 742,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 742
        }
      },
      {
        "_id": "5b659db4e0ea98de8227750eb75526ee",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "accept-language",
              "value": "en-US"
            },
            {
              "_fromType": "array",
              "name": "x-ms-client-request-id",
              "value": "a35ddd55-d8c9-474e-8497-810cbcf7c5c2"
            },
            {
              "_fromType": "array",
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "_fromType": "array",
              "name": "authorization",
              "value": "[REDACTED]"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "ms-rest-js/2.0.7 Node/v18.16.0 OS/(x64-Darwin-23.4.0)"
            },
            {
              "_fromType": "array",
              "name": "cookie",
              "value": ""
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "management.azure.com"
            }
          ],
          "headersSize": 1695,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "api-version",
              "value": "2016-06-01"
            }
          ],
          "url": "https://management.azure.com/subscriptions?api-version=2016-06-01"
        },
        "response": {
          "bodySize": 688,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 688,
            "text": "{\"value\":[{\"id\":\"/subscriptions/f4e36c12-e09f-44c8-b660-69594ee88137\",\"authorizationSource\":\"RoleBased\",\"subscriptionId\":\"f4e36c12-e09f-44c8-b660-69594ee88137\",\"displayName\":\"Access to Azure Active Directory\",\"state\":\"Disabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Public_2014-09-01\",\"quotaId\":\"PayAsYouGo_2014-09-01\",\"spendingLimit\":\"Off\"}},{\"id\":\"/subscriptions/subscription-id\",\"authorizationSource\":\"RoleBased\",\"subscriptionId\":\"subscription-id\",\"displayName\":\"jupiterone-integration-dev\",\"state\":\"Enabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Public_2014-09-01\",\"quotaId\":\"PayAsYouGo_2014-09-01\",\"spendingLimit\":\"Off\"}}]}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-length",
              "value": "688"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "x-ms-ratelimit-remaining-tenant-reads",
              "value": "11999"
            },
            {
              "name": "x-ms-request-id",
              "value": "9ed82bfa-1f18-4d62-b879-135c4fec9c18"
            },
            {
              "name": "x-ms-correlation-request-id",
              "value": "9ed82bfa-1f18-4d62-b879-135c4fec9c18"
            },
            {
              "name": "x-ms-routing-request-id",
              "value": "BRAZILSOUTH:20240405T173546Z:9ed82bfa-1f18-4d62-b879-135c4fec9c18"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-cache",
              "value": "CONFIG_NOCACHE"
            },
            {
              "name": "x-msedge-ref",
              "value": "Ref A: 4F9AFB31E6BD4A0C8F9A127924C921A8 Ref B: RIO201060612021 Ref C: 2024-04-05T17:35:45Z"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:45 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:45.394Z",
        "time": 597,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 597
        }
      },
      {
        "_id": "16ed5b00f3279cf0ee48473ae4ff7412",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "_fromType": "array",
              "name": "accept-language",
              "value": "en-US"
            },
            {
              "_fromType": "array",
              "name": "x-ms-client-request-id",
              "value": "9a0b8301-a8d9-41c6-8e61-f3decd62c9ae"
            },
            {
              "_fromType": "array",
              "name": "authorization",
              "value": "[REDACTED]"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "@azure/arm-subscriptions/2.0.0 ms-rest-azure-js/2.0.1 ms-rest-js/2.0.7 Node/v18.16.0 OS/(x64-Darwin-23.4.0)"
            },
            {
              "_fromType": "array",
              "name": "cookie",
              "value": ""
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "management.azure.com"
            }
          ],
          "headersSize": 1786,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "api-version",
              "value": "2020-01-01"
            }
          ],
          "url": "https://management.azure.com/subscriptions/subscription-id?api-version=2020-01-01"
        },
        "response": {
          "bodySize": 562,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 562,
            "text": "{\"id\":\"/subscriptions/subscription-id\",\"authorizationSource\":\"RoleBased\",\"managedByTenants\":[{\"tenantId\":\"33e01921-4d64-4f8c-a055-5bdaffd5e33d\"},{\"tenantId\":\"2f4a9838-26b7-47ee-be60-ccc1fdec5953\"}],\"tags\":{\"Dev\":\"true\",\"AccountId\":\"ExampleAccountID\"},\"subscriptionId\":\"subscription-id\",\"tenantId\":\"directory-id\",\"displayName\":\"jupiterone-integration-dev\",\"state\":\"Enabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Public_2014-09-01\",\"quotaId\":\"PayAsYouGo_2014-09-01\",\"spendingLimit\":\"Off\"}}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-length",
              "value": "562"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "x-ms-ratelimit-remaining-subscription-reads",
              "value": "11999"
            },
            {
              "name": "x-ms-request-id",
              "value": "e9378337-a78c-4d56-9fb4-81593e057cea"
            },
            {
              "name": "x-ms-correlation-request-id",
              "value": "e9378337-a78c-4d56-9fb4-81593e057cea"
            },
            {
              "name": "x-ms-routing-request-id",
              "value": "BRAZILSOUTH:20240405T173546Z:e9378337-a78c-4d56-9fb4-81593e057cea"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-cache",
              "value": "CONFIG_NOCACHE"
            },
            {
              "name": "x-msedge-ref",
              "value": "Ref A: 67D5BC06EA4245848985CFC80AD86F36 Ref B: RIO201060613021 Ref C: 2024-04-05T17:35:46Z"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:46 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            }
          ],
          "headersSize": 676,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:46.007Z",
        "time": 527,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 527
        }
      },
      {
        "_id": "4eab979841c1f2185e48b484c23ec3e2",
        "_order": 1,
        "cache": {},
        "request": {
          "bodySize": 178,
          "cookies": [],
          "headers": [
            {
              "name": "content-type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "name": "accept-charset",
              "value": "utf-8"
            },
            {
              "name": "client-request-id",
              "value": "ddce8946-f381-4a9d-b853-d26d513785f4"
            },
            {
              "name": "return-client-request-id",
              "value": "true"
            },
            {
              "name": "x-client-sku",
              "value": "Node"
            },
            {
              "name": "x-client-ver",
              "value": "0.1.28"
            },
            {
              "name": "x-client-os",
              "value": "darwin"
            },
            {
              "name": "x-client-cpu",
              "value": "x64"
            },
            {
              "name": "host",
              "value": "login.microsoftonline.com"
            },
            {
              "name": "content-length",
              "value": 178
            }
          ],
          "headersSize": 414,
          "httpVersion": "HTTP/1.1",
          "method": "POST",
          "postData": {
            "mimeType": "application/x-www-form-urlencoded",
            "params": [],
            "text": "[REDACTED]"
          },
          "queryString": [
            {
              "name": "api-version",
              "value": "1.0"
            }
          ],
          "url": "https://login.microsoftonline.com/directory-id/oauth2/token?api-version=1.0"
        },
        "response": {
          "bodySize": 1468,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 1468,
            "text": "{\"token_type\":\"Bearer\",\"expires_in\":\"3599\",\"ext_expires_in\":\"3599\",\"expires_on\":\"1712342147\",\"not_before\":\"1712338247\",\"resource\":\"https://management.azure.com/\",\"access_token\":\"[REDACTED]\"}"
          },
          "cookies": [
            {
              "expires": "2024-05-05T17:35:47.000Z",
              "httpOnly": true,
              "name": "fpc",
              "path": "/",
              "sameSite": "None",
              "secure": true,
              "value": "[REDACTED]"
            },
            {
              "httpOnly": true,
              "name": "x-ms-gateway-slice",
              "path": "/",
              "secure": true,
              "value": "[REDACTED]"
            },
            {
              "httpOnly": true,
              "name": "stsservicecookie",
              "path": "/",
              "secure": true,
              "value": "[REDACTED]"
            }
          ],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-store, no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "p3p",
              "value": "CP=\"DSP CUR OTPi IND OTRi ONL FIN\""
            },
            {
              "name": "client-request-id",
              "value": "ddce8946-f381-4a9d-b853-d26d513785f4"
            },
            {
              "name": "x-ms-request-id",
              "value": "face09d6-cae7-47e7-b961-b15848d70600"
            },
            {
              "name": "x-ms-ests-server",
              "value": "2.1.17750.6 - EUS ProdSlices"
            },
            {
              "name": "x-ms-clitelem",
              "value": "1,0,0,,"
            },
            {
              "name": "x-ms-srs",
              "value": "1.P"
            },
            {
              "name": "x-xss-protection",
              "value": "0"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "set-cookie",
              "value": "[REDACTED]"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:46 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            },
            {
              "name": "content-length",
              "value": "1468"
            }
          ],
          "headersSize": 821,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:46.554Z",
        "time": 535,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 535
        }
      },
      {
        "_id": "5b659db4e0ea98de8227750eb75526ee",
        "_order": 1,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "accept-language",
              "value": "en-US"
            },
            {
              "_fromType": "array",
              "name": "x-ms-client-request-id",
              "value": "455b0a7a-69cb-4fb5-a7ef-3497a8a76939"
            },
            {
              "_fromType": "array",
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "_fromType": "array",
              "name": "authorization",
              "value": "[REDACTED]"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "ms-rest-js/2.0.7 Node/v18.16.0 OS/(x64-Darwin-23.4.0)"
            },
            {
              "_fromType": "array",
              "name": "cookie",
              "value": ""
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "management.azure.com"
            }
          ],
          "headersSize": 1695,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "api-version",
              "value": "2016-06-01"
            }
          ],
          "url": "https://management.azure.com/subscriptions?api-version=2016-06-01"
        },
        "response": {
          "bodySize": 688,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 688,
            "text": "{\"value\":[{\"id\":\"/subscriptions/f4e36c12-e09f-44c8-b660-69594ee88137\",\"authorizationSource\":\"RoleBased\",\"subscriptionId\":\"f4e36c12-e09f-44c8-b660-69594ee88137\",\"displayName\":\"Access to Azure Active Directory\",\"state\":\"Disabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Public_2014-09-01\",\"quotaId\":\"PayAsYouGo_2014-09-01\",\"spendingLimit\":\"Off\"}},{\"id\":\"/subscriptions/subscription-id\",\"authorizationSource\":\"RoleBased\",\"subscriptionId\":\"subscription-id\",\"displayName\":\"jupiterone-integration-dev\",\"state\":\"Enabled\",\"subscriptionPolicies\":{\"locationPlacementId\":\"Public_2014-09-01\",\"quotaId\":\"PayAsYouGo_2014-09-01\",\"spendingLimit\":\"Off\"}}]}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-length",
              "value": "688"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "x-ms-ratelimit-remaining-tenant-reads",
              "value": "11999"
            },
            {
              "name": "x-ms-request-id",
              "value": "c60cf59d-57c7-4ed2-9158-691d4134cd2a"
            },
            {
              "name": "x-ms-correlation-request-id",
              "value": "c60cf59d-57c7-4ed2-9158-691d4134cd2a"
            },
            {
              "name": "x-ms-routing-request-id",
              "value": "BRAZILSOUTH:20240405T173547Z:c60cf59d-57c7-4ed2-9158-691d4134cd2a"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-cache",
              "value": "CONFIG_NOCACHE"
            },
            {
              "name": "x-msedge-ref",
              "value": "Ref A: ECE090F620844F9EA0B84DE9A7DBAD51 Ref B: RIO201060613047 Ref C: 2024-04-05T17:35:47Z"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:47 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            }
          ],
          "headersSize": 670,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:47.098Z",
        "time": 311,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 311
        }
      },
      {
        "_id": "340e42e3a01709150f9192f713b08435",
        "_order": 0,
        "cache": {},
        "request": {
          "bodySize": 0,
          "cookies": [],
          "headers": [
            {
              "_fromType": "array",
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "_fromType": "array",
              "name": "accept-language",
              "value": "en-US"
            },
            {
              "_fromType": "array",
              "name": "x-ms-client-request-id",
              "value": "09af13be-77dc-4b32-ad00-eca1a4f4bf9c"
            },
            {
              "_fromType": "array",
              "name": "authorization",
              "value": "[REDACTED]"
            },
            {
              "_fromType": "array",
              "name": "user-agent",
              "value": "@azure/arm-security/2.0.0 ms-rest-azure-js/2.0.1 ms-rest-js/2.0.7 Node/v18.16.0 OS/(x64-Darwin-23.4.0)"
            },
            {
              "_fromType": "array",
              "name": "cookie",
              "value": ""
            },
            {
              "_fromType": "array",
              "name": "accept",
              "value": "*/*"
            },
            {
              "_fromType": "array",
              "name": "accept-encoding",
              "value": "gzip,deflate"
            },
            {
              "_fromType": "array",
              "name": "connection",
              "value": "close"
            },
            {
              "name": "host",
              "value": "management.azure.com"
            }
          ],
          "headersSize": 1817,
          "httpVersion": "HTTP/1.1",
          "method": "GET",
          "queryString": [
            {
              "name": "api-version",
              "value": "2019-01-01"
            }
          ],
          "url": "https://management.azure.com/subscriptions/subscription-id/providers/Microsoft.Security/alerts?api-version=2019-01-01"
        },
        "response": {
          "bodySize": 335431,
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 335431,
            "text": "{\"value\":[{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795592690621_fff0d6d1-79ee-438c-b986-2022d4a174c3\",\"name\":\"2516899795592690621_fff0d6d1-79ee-438c-b986-2022d4a174c3\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious WordPress theme invocation detected\",\"alertName\":\"SIMULATED_APPS_WpThemeInjection\",\"detectedTimeUtc\":\"2024-04-05T12:47:20.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: The Azure App Service activity log indicates a possible code injection activity on your App Service resource.\\r\\nThe suspicious activity detected resembles that of a manipulation of WordPress theme to support server side execution of code, followed by a direct web request to invoke the manipulated theme file.\\r\\nThis type of activity was seen in the past as part of an attack campaign over WordPress.\",\"remediationSteps\":\"1. If WordPress is installed, make sure that the application is up to date and automatic updates are enabled.\\r\\n2. If only specific IP addresses should be allowed to access the web app, set IP restrictions (https://docs.microsoft.com/azure/app-service/app-service-ip-restrictions) for it.\",\"actionTaken\":\"Detected\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-App\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"18194225-475f-4f71-a841-2b46ae1be313\",\"extendedProperties\":{\"resourceType\":\"App Service\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"compromisedEntity\":\"Sample-App\",\"productComponentName\":\"App Service\",\"effectiveSubscriptionId\":\"subscription-id\",\"actionTaken\":\"Detected\",\"sample URIs\":\"/login.php\",\"sample Source IP Addresses\":\"00.00.00.00\",\"sample User Agents\":\"Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64;+rv:48.0)+Gecko/20100101+Firefox/48.0, Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/63.0.3239.132+Safari/537.36\",\"sample Referer\":\"-\",\"last Event Time\":\"12/11/2019 12:34:27 AM\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.045Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_1\",\"hostName\":\"Sample-App\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_2\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"resourceType\":\"App Service\",\"resourceName\":\"Sample-App\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795612690621_96b84f42-cc5d-46e3-972c-a1d5ad191a99\",\"name\":\"2516899795612690621_96b84f42-cc5d-46e3-972c-a1d5ad191a99\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Phishing content hosted on Azure Webapps\",\"alertName\":\"SIMULATED_MaliciousContent-AzureWebApps\",\"detectedTimeUtc\":\"2024-04-05T12:47:18.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: URL used for phishing attack found on the Azure AppServices website. This URL was part of a phishing attack sent to O365 customers. The content typically lure visitors into entering their corporate credentials or financial information into a legitimate looking website.\",\"remediationSteps\":\"1. Use Azure Web Sites Process Explorer and try to identify unknown running processes (see https://blogs.msdn.microsoft.com/waws/2014/11/14/viewing-process-information-for-microsoft-azure-web-sites/)\\r\\n2. Escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-App\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"698c5ab0-78d0-2ae7-cfc8-35e1803f675f\",\"extendedProperties\":{\"resourceType\":\"App Service\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"compromisedEntity\":\"Sample-App\",\"productComponentName\":\"App Service\",\"effectiveSubscriptionId\":\"subscription-id\",\"url\":\"https://sample.azurewebsites.net\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.165Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_3\",\"url\":\"https://sample.azurewebsites.net\",\"asset\":false,\"type\":\"url\"},{\"$id\":\"centralus_4\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"resourceType\":\"App Service\",\"resourceName\":\"Sample-App\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795632690621_1e673913-117f-4aab-8ae4-6c3f17571857\",\"name\":\"2516899795632690621_1e673913-117f-4aab-8ae4-6c3f17571857\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] User accessed high volume of Key Vaults\",\"alertName\":\"SIMULATED_KV_OperationVolumeAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:47:16.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: While may be benign it could also indicate that a larger volume of Key Vault operations has been performed compared to past historical data. Key Vaults typical exhibit the same behavior over time. This may be a legitimate change in activity but may also indicate that your Key Vault infrastructure has been compromised warranting further investigation.\",\"remediationSteps\":\"Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-KV\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"5d781fcb-f93f-9a9e-95e8-13f8a663d224\",\"extendedProperties\":{\"resourceType\":\"Key Vault\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"compromisedEntity\":\"Sample-KV\",\"productComponentName\":\"Key Vault\",\"effectiveSubscriptionId\":\"subscription-id\",\"end Time UTC\":\"04/05/2024 12:47:16\",\"all vault operations in last 24 hours\":\"[SecretSet:1, SecretGet:5, Authentication:2, VaultGet:3]\",\"suspicious Operations\":\"[SecretGet:2, VaultGet:2]\",\"attacker IP Address\":\"00.00.00.00\",\"attacker Object ID\":\"00000000-0000-0000-0000-000000000000\",\"client Information\":\"Microsoft.Azure.Management.Resources.ResourceManagementClient/2.0.0.0, \",\"result Signature\":\"OK\",\"application ID\":\"00000000-0000-0000-0000-000000000000\",\"start Time UTC\":\"04/05/2024 12:47:16\",\"alert Reasons\":\"[The application(appid) does not usually come from this IP, The application(appid) performed more operations than usual, The user(objid) does not usually come from this IP, The user(objid) performed more operations than usual, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively\",\"target\":\"https://sample.vault.azure.net/secrets/sample\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.322Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_5\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"resourceType\":\"Key Vault\",\"resourceName\":\"Sample-KV\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_6\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":false,\"isValid\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_7\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\"},\"asset\":false,\"type\":\"ip\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795652690621_56d650e0-c22e-4ae4-8076-577abd1025fe\",\"name\":\"2516899795652690621_56d650e0-c22e-4ae4-8076-577abd1025fe\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] High volume of operations in a Key Vault\",\"alertName\":\"SIMULATED_KV_AccountVolumeAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:47:14.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: While may be benign it could also indicate that the number of vaults that a user or application accesses has changed compared to past historical data. Key Vault activity typically exhibits the same behavior over time. This may be a legitimate change in activity but may also indicate that your Key Vault infrastructure has been compromised warranting further investigation.\",\"remediationSteps\":\"Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-KV\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c5a37068-7519-cf61-aa6e-1872473afada\",\"extendedProperties\":{\"resourceType\":\"Key Vault\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"compromisedEntity\":\"Sample-KV\",\"productComponentName\":\"Key Vault\",\"effectiveSubscriptionId\":\"subscription-id\",\"end Time UTC\":\"04/05/2024 12:47:14\",\"all vault operations in last 24 hours\":\"[AfterAuthentication:1, SecretGet:345545, EventGridGetAllSubscriptions:19, Authentication:169, VaultGet:3]\",\"suspicious Operations\":\"[SecretGet:64]\",\"attacker IP Address\":\"00.00.00.00\",\"attacker Object ID\":\"00000000-0000-0000-0000-000000000000\",\"result Signature\":\"OK\",\"application ID\":\"00000000-0000-0000-0000-000000000000\",\"start Time UTC\":\"04/05/2024 12:47:14\",\"alert Reasons\":\"[The application(appid) accessed more vaults than usual, The application(appid) does not usually come from this IP, The user(objid) accessed more vaults than usual, The user(objid) does not usually come from this IP, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively\",\"target\":\"https://sample.vault.azure.net/secrets/sample\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.369Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_8\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"resourceType\":\"Key Vault\",\"resourceName\":\"Sample-KV\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_9\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":false,\"isValid\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_10\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\"},\"asset\":false,\"type\":\"ip\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795672690621_85b1357d-8010-4c71-a2b0-d63edf3bf020\",\"name\":\"2516899795672690621_85b1357d-8010-4c71-a2b0-d63edf3bf020\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious secret listing and query in a Key Vault\",\"alertName\":\"SIMULATED_KV_ListGetAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:47:12.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: While may be benign it could also indicate that a Secret List operation was followed by numerous Secret Get operations. In addition, this operation pattern is not normally performed by the user on this vault. This is likely indicative that someone is dumping the This is sample alert: secrets stored in the Key Vault for potentially malicious purposes.\",\"remediationSteps\":\"Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-KV\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"70301490-9c74-32cb-c3b2-a8ed18b75dc4\",\"extendedProperties\":{\"resourceType\":\"Key Vault\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"compromisedEntity\":\"Sample-KV\",\"productComponentName\":\"Key Vault\",\"effectiveSubscriptionId\":\"subscription-id\",\"end Time UTC\":\"04/05/2024 12:47:12\",\"all vault operations in last 24 hours\":\"[Authentication:1, SecretGet:3, VaultGet:1, SecretList:5]\",\"suspicious Operations\":\"[SecretGet:3, SecretList:5]\",\"attacker IP Address\":\"00.00.00.00\",\"attacker Object ID\":\"00000000-0000-0000-0000-000000000000\",\"client Information\":\"FxVersion/4.8.4075.0 OSName/Windows10Enterprise OSVersion/6.3.18363 Microsoft.Azure.KeyVault.KeyVaultClient/3.0.0.1\",\"result Signature\":\"OK\",\"application ID\":\"00000000-0000-0000-0000-000000000000\",\"start Time UTC\":\"04/05/2024 12:47:12\",\"alert Reasons\":\"[The application(appid) does not usually access this vault, The application(appid) does not usually come from this IP, The application(appid) does not usually perform a credential list operation followed by a get operation, The application(appid) does not usually perform this operation, The number of applications which accessed this vault is more than usual, The number of users(objid) who accessed this vault is more than usual, The user(objid) does not usually access this vault, The user(objid) does not usually come from this IP, The user(objid) does not usually perform a credential list operation followed by a get operation, The user(objid) does not usually perform this operation, This vault does not usually have a credential list operation followed by a get operation, This vault does not usually have this operation, This vault had more operations than usual, This vault had more types of operations than usual, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively\",\"target\":\"https://sample.vault.azure.net/secrets/sample\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.42Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_11\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"resourceType\":\"Key Vault\",\"resourceName\":\"Sample-KV\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_12\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":false,\"isValid\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_13\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\"},\"asset\":false,\"type\":\"ip\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795692690621_62d45aa3-82d8-40f3-9992-275b401f729b\",\"name\":\"2516899795692690621_62d45aa3-82d8-40f3-9992-275b401f729b\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious policy change and secret query in a Key Vault\",\"alertName\":\"SIMULATED_KV_PutGetAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:47:10.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: While may be benign it could also indicate that a Key Vault policy change has been made and operations to list and/or get secrets occurred shortly thereafter. In addition, this operation pattern is not normally performed by the user on this vault. This is highly indicative that the Key Vault has been compromised and the secrets within have been stolen by a malicious actor.\",\"remediationSteps\":\"Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-KV\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"4c4bb8d0-4258-2bbf-c55b-7e919ac2c619\",\"extendedProperties\":{\"resourceType\":\"Key Vault\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"compromisedEntity\":\"Sample-KV\",\"productComponentName\":\"Key Vault\",\"effectiveSubscriptionId\":\"subscription-id\",\"end Time UTC\":\"04/05/2024 12:47:10\",\"all vault operations in last 24 hours\":\"[VaultGet:14, CertificateImport:1, CertificateGet:479, VaultPut:4, SecretGet:760, Authentication:3]\",\"suspicious Operations\":\"[SecretGet:2, VaultPut:4, VaultGet:5, CertificateGet:24]\",\"attacker IP Address\":\"00.00.00.00\",\"attacker Object ID\":\"00000000-0000-0000-0000-000000000000\",\"client Information\":\"FxVersion/4.8.4121.0, FxVersion/4.8.4121.0 OSName/Windows10Enterprise OSVersion/6.3.17763 Microsoft.Azure.KeyVault.KeyVaultClient/3.0.0.1\",\"result Signature\":\"OK\",\"application ID\":\"00000000-0000-0000-0000-000000000000\",\"start Time UTC\":\"04/05/2024 12:47:10\",\"alert Reasons\":\"[The application(appid) does not usually come from this IP, The application(appid) does not usually perform a policy change operation followed by a credential get operation, The application(appid) does not usually perform this operation, The user(objid) does not usually come from this IP, The user(objid) does not usually perform a policy change operation followed by a credential get operation, The user(objid) does not usually perform this operation, This vault does not usually have a policy change operation followed by a credential get operation, This vault does not usually have this operation, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively\",\"target\":\"https://sample.vault.azure.net/secrets/sample\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.467Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_14\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"resourceType\":\"Key Vault\",\"resourceName\":\"Sample-KV\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_15\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":false,\"isValid\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_16\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\"},\"asset\":false,\"type\":\"ip\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795712690621_e1747a9a-cd49-48fb-a1c5-a64448bd3ef1\",\"name\":\"2516899795712690621_e1747a9a-cd49-48fb-a1c5-a64448bd3ef1\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a TOR exit node to a Key Vault\",\"alertName\":\"SIMULATED_KV_TORAccess\",\"detectedTimeUtc\":\"2024-04-05T12:47:08.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: While may be benign it could also indicate that the Key Vault has been accessed by someone using the TOR IP anonymization system to hide their true source location. This is suspicious because malicious actors will often try to mask their source location when attempting to gain unauthorized access to internet-connected resources.\",\"remediationSteps\":\"Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-KV\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"aca851d0-0616-9f2c-238c-bc2bcf5511b9\",\"extendedProperties\":{\"resourceType\":\"Key Vault\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"compromisedEntity\":\"Sample-KV\",\"productComponentName\":\"Key Vault\",\"effectiveSubscriptionId\":\"subscription-id\",\"end Time UTC\":\"04/05/2024 12:47:08\",\"all vault operations in last 24 hours\":\"[Authentication:777440, SecretSet:1, SecretGet:777399]\",\"suspicious Operations\":\"[Authentication:1, SecretGet:1]\",\"attacker IP Address\":\"00.00.00.00\",\"attacker Object ID\":\"00000000-0000-0000-0000-000000000000\",\"client Information\":\"python/3.8.0 (Windows-10-10.0.17763-SP0) msrest/0.6.11 msrest_azure/0.6.2 azure-keyvault/7.0 Azure-SDK-For-Python\",\"result Signature\":\"Not Found, Unauthorized\",\"application ID\":\"00000000-0000-0000-0000-000000000000\",\"start Time UTC\":\"04/05/2024 12:47:08\",\"alert Reasons\":\"[The Key Vault has been accessed by someone using the TOR IP anonymization system to hide their true source location.]\",\"target\":\"https://sample.vault.azure.net/secrets/sample\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.514Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_17\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV\",\"resourceType\":\"Key Vault\",\"resourceName\":\"Sample-KV\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_18\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":false,\"isValid\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_19\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\"},\"asset\":false,\"type\":\"ip\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795732690621_a4f885be-4d7d-4c59-92b2-d9de82b27dfe\",\"name\":\"2516899795732690621_a4f885be-4d7d-4c59-92b2-d9de82b27dfe\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Container with a sensitive volume mount detected (Preview)\",\"alertName\":\"SIMULATED_K8S_SensitiveMount\",\"detectedTimeUtc\":\"2024-04-05T12:47:06.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected a new container with a sensitive volume mount. The volume that was detected is a hostPath type which mounts a sensitive file or folder from the node to the container. If the container gets compromised, the attacker can use this mount for gaining access to the node.\",\"remediationSteps\":\"Review the container and the path in the alert details.\\r\\nIf possible, consider mounting only specific folders or files that are necessary to the container operation.\\r\\nIf the container is not legitimate, escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Cluster\",\"associatedResource\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"8f8f76d4-8d96-a308-6699-87953af8b543\",\"extendedProperties\":{\"resourceType\":\"GCP GKE Cluster\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"compromisedEntity\":\"Sample-Cluster\",\"productComponentName\":\"Containers\",\"effectiveSubscriptionId\":\"subscription-id\",\"namespace\":\"Sample-namespace\",\"container name\":\"sample-container\",\"container image\":\"sample-image\",\"pod name\":\"sample-pod\",\"sensitive mount name\":\"sample-mount\",\"sensitive mount path\":\"/Sample\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.577Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_20\",\"imageId\":\"sample-image:v1\",\"friendlyName\":\"sample-image:v1\",\"asset\":false,\"type\":\"container-image\"},{\"$id\":\"centralus_21\",\"cloudResource\":{\"$id\":\"centralus_22\",\"resourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"resourceType\":\"GCP GKE Cluster\",\"resourceName\":\"gcp-clusters-sample-cluster-us-central1-c\",\"type\":\"azure-resource\"},\"asset\":false,\"type\":\"K8s-cluster\"},{\"$ref\":\"centralus_22\"},{\"$id\":\"centralus_23\",\"name\":\"Sample-namespace\",\"cluster\":{\"$ref\":\"centralus_21\"},\"friendlyName\":\"Sample-namespace\",\"asset\":false,\"type\":\"K8s-namespace\"},{\"$id\":\"centralus_24\",\"name\":\"sample-pod\",\"namespace\":{\"$ref\":\"centralus_23\"},\"friendlyName\":\"Sample-namespace/sample-pod\",\"asset\":false,\"type\":\"K8s-pod\"},{\"$id\":\"centralus_25\",\"name\":\"sample-container\",\"image\":{\"$ref\":\"centralus_20\"},\"pod\":{\"$ref\":\"centralus_24\"},\"friendlyName\":\"sample-container\",\"asset\":false,\"type\":\"container\"},{\"$id\":\"centralus_26\",\"fullResourceName\":\"//container.googleapis.com/projects/012345678901/zones/us-central1-c/clusters/Sample-Cluster\",\"projectId\":\"012345678901\",\"resourceType\":\"GCP GKE Cluster\",\"resourceName\":\"Sample-Cluster\",\"location\":\"us-central1-c\",\"locationType\":\"Zonal\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"gcp-resource\",\"entityIds\":[{\"Type\":\"MdcConnectorResourceAzureId\",\"Id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\"}],\"relatedAzureResourceIds\":{\"MulticloudResourceMDCAzureId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"MdcConnectorResourceAzureId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\"}}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795752690621_97b75c97-5c67-416b-9dfc-04ae2f9509c0\",\"name\":\"2516899795752690621_97b75c97-5c67-416b-9dfc-04ae2f9509c0\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Creation of admission webhook configuration detected\",\"alertName\":\"SIMULATED_K8S_AdmissionController\",\"detectedTimeUtc\":\"2024-04-05T12:47:04.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected a new admission webhook configuration. Kubernetes has two built-in generic admission controllers: MutatingAdmissionWebhook and ValidatingAdmissionWebhook. The behavior of these admission controllers is determined by an admission webhook that the user deploys to the cluster. The usage of such admission controllers can be legitimate, however attackers can use such webhooks for modifying the requests (in case of MutatingAdmissionWebhook) or inspecting the requests and gain sensitive information (in case of ValidatingAdmissionWebhook).\",\"remediationSteps\":\"Review the admission controller webhook associated with this configuration. The details of the webhook configuration can be retrieved by the command:\\r\\nkubectl get mutatingwebhookconfigurations sample -o json\\r\\nIf this configuration belongs to a legitimate admission controller in the cluster, you can ignore the alert.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-Cluster\",\"associatedResource\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.ContainerService/ManagedClusters/Sample-Cluster\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"88ce40c5-58c1-7456-c272-0277a70de9b4\",\"extendedProperties\":{\"resourceType\":\"Kubernetes Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.ContainerService/ManagedClusters/Sample-Cluster\",\"compromisedEntity\":\"Sample-Cluster\",\"productComponentName\":\"Containers\",\"effectiveSubscriptionId\":\"subscription-id\",\"resource type\":\"mutatingwebhookconfigurations\",\"resource name\":\"sample\",\"webhook configuration rules\":\"[{\\\"apiGroups\\\":[\\\"*\\\"],\\\"resources\\\":[\\\"pods\\\"],\\\"apiVersions\\\":[\\\"*\\\"],\\\"operations\\\":[\\\"CREATE\\\"],\\\"scope\\\":\\\"*\\\"}]\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.665Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_27\",\"resourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.ContainerService/ManagedClusters/Sample-Cluster\",\"resourceType\":\"Kubernetes Service\",\"resourceName\":\"Sample-Cluster\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_28\",\"cloudResource\":{\"$ref\":\"centralus_27\"},\"asset\":false,\"type\":\"K8s-cluster\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795792534930_1b9043b8-57c5-4772-98f9-ffe76514b8fb\",\"name\":\"2516899795792534930_1b9043b8-57c5-4772-98f9-ffe76514b8fb\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspected brute-force attack attempt\",\"alertName\":\"SIMULATED_SQL.DB_BruteForce\",\"detectedTimeUtc\":\"2024-04-05T12:47:00.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone is attempting to brute force credentials to your SQL server 'Sample-SQL'.\",\"remediationSteps\":\"Go to the firewall settings in order to lock down the firewall as tightly as possible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-SQL\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"f0d6e350-7f9a-0bf3-9c27-5cf381c9b9e0\",\"extendedProperties\":{\"resourceType\":\"SQL Database\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"compromisedEntity\":\"Sample-SQL\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"Brute force attack, penetration testing.\",\"client IP Address\":\"00.00.00.00\",\"client Principal Name\":\"Sample-account\",\"client Application\":\"Sample-app\",\"client IP Location\":\"Boydton, United States\",\"recommendations\":\"{\\\"displayValue\\\":\\\"Ensure the use of strong passwords, and avoid reusing them across multiple databases.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2099068\\\"}\",\"data Center\":\"East US 2\",\"failed Logins\":\"0\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.9Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_29\",\"address\":\"00.00.00.00\",\"location\":{\"countryName\":\"United States\",\"city\":\"Boydton\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_30\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"resourceType\":\"SQL Database\",\"resourceName\":\"Sample-DB\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795812534930_4e02d04a-da87-4441-a1f3-2cda40c24d08\",\"name\":\"2516899795812534930_4e02d04a-da87-4441-a1f3-2cda40c24d08\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Attempted logon by a potentially harmful application\",\"alertName\":\"SIMULATED_SQL.DB_HarmfulApplication\",\"detectedTimeUtc\":\"2024-04-05T12:46:58.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: A potentially harmful application attempted to access  SQL server 'Sample-SQL'.\",\"remediationSteps\":\"Go to the firewall settings in order to lock down the firewall as tightly as possible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-SQL\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"0df337f6-708a-c43d-0a26-54d9c8341f09\",\"extendedProperties\":{\"resourceType\":\"SQL Database\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"compromisedEntity\":\"Sample-SQL\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"Penetration testing, malicious activity\",\"successful Logins from potentially harmful application\":\"1\",\"client IP Address\":\"00.00.00.00\",\"client Principal Name\":\"Sample-account\",\"client Application\":\"Sample-app\",\"client IP Location\":\"Boydton, United States\",\"recommendations\":\"{\\\"displayValue\\\":\\\"Ensure the use of strong passwords, and avoid reusing them across multiple databases.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2099068\\\"}\",\"data Center\":\"East US 2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.947Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_31\",\"address\":\"00.00.00.00\",\"location\":{\"countryName\":\"United States\",\"city\":\"Boydton\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_32\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"resourceType\":\"SQL Database\",\"resourceName\":\"Sample-DB\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795832534930_b4dc49b9-6d30-4232-b4df-90d3b096d484\",\"name\":\"2516899795832534930_b4dc49b9-6d30-4232-b4df-90d3b096d484\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Potential SQL Injection\",\"alertName\":\"SIMULATED_SQL.DB_PotentialSqlInjection\",\"detectedTimeUtc\":\"2024-04-05T12:46:56.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Potential SQL Injection was detected on your database elitronix-com on server Sample-SQL\",\"remediationSteps\":\"{\\\"displayValue\\\":\\\"Read more about SQL Injection threats and best practices for safe application code.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/www.microsoft.com\\\\/en-us\\\\/download\\\\/details.aspx?id=13759\\\"}\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-SQL\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c384ebdd-3c44-871d-8aa6-05c7bbfc7502\",\"extendedProperties\":{\"resourceType\":\"SQL Database\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"compromisedEntity\":\"Sample-SQL\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"Defect in application code constructing faulty SQL statements; application code doesn't sanitize user input and was exploited to inject malicious SQL statements.\",\"threat ID\":\"30\",\"ip address\":\"00.00.00.00\",\"principal name\":\"Sample-account\",\"application\":\"Internet Information Services\",\"database\":\"Sample-DB\",\"server\":\"Sample-SQL\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.998Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_33\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"resourceType\":\"SQL Database\",\"resourceName\":\"Sample-DB\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_34\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Iowa\",\"city\":\"Des Moines\"},\"asset\":false,\"type\":\"ip\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795852534930_0b71856d-1de2-49d5-ba21-9e3f69d7f96d\",\"name\":\"2516899795852534930_0b71856d-1de2-49d5-ba21-9e3f69d7f96d\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Logon from an unusual location\",\"alertName\":\"SIMULATED_SQL.DB_GeoAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:46:54.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone logged on to your SQL server Sample-SQL from an unusual location.\",\"remediationSteps\":\"Go to the firewall settings in order to lock down the firewall as tightly as possible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-SQL\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"e4f124a5-6e45-d65e-35b2-d7b632894a7c\",\"extendedProperties\":{\"resourceType\":\"SQL Database\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"compromisedEntity\":\"Sample-SQL\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"potential causes\":\"Unauthorized access that exploits an opening in the firewall; legitimate access from a new location.\",\"client IP Address\":\"00.00.00.00\",\"client Principal Name\":\"Sample-account\",\"client Application\":\"Microsoft SQL Server Management Studio\",\"client IP Location\":\"US\",\"recommendations\":\"{\\\"displayValue\\\":\\\"Ensure the use of strong passwords, and avoid reusing them across multiple databases.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2099068\\\"}\",\"client Hostname\":\"Sample-VM\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.04Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_35\",\"address\":\"00.00.00.00\",\"location\":{\"countryName\":\"US\",\"city\":\"New York\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_36\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB\",\"resourceType\":\"SQL Database\",\"resourceName\":\"Sample-DB\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795972378081_e76df9e5-1f5f-4ab8-94c6-a47d3cc29d38\",\"name\":\"2516899795972378081_e76df9e5-1f5f-4ab8-94c6-a47d3cc29d38\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Executable found running from a suspicious location\",\"alertName\":\"SIMULATED_VM_SuspectExecutablePath\",\"detectedTimeUtc\":\"2024-04-05T12:46:42.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of host data detected an executable file on Sample-VM that is running from a location in common with known suspicious files. This executable could either be legitimate activity, or an indication of a compromised host.\",\"remediationSteps\":\"Review with %{User Name} the suspicious process in this alert to see if you recognise this as legitimate administrative activity. If not, Escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"77ab8588-14fa-df48-93f0-f7e2d60f55d9\",\"extendedProperties\":{\"user Name\":\"WORKGROUP\\\\Sample-account\",\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Servers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"Sample-VM\",\"suspicious Process\":\"c:\\\\windows\\\\inf\\\\sample.exe\",\"suspicious Command Line\":\"c:\\\\windows\\\\inf\\\\sample.exe\",\"suspicious Process Id\":\"0x1eec\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"defaultresourcegroup-wus\",\"account Session Id\":\"0x3e7\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.436Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_37\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"Sample-VM\",\"netBiosName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"osFamily\":\"Windows\",\"osVersion\":\"Windows\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_38\",\"name\":\"SAMPLE-account\",\"ntDomain\":\"SAMPLE\",\"host\":{\"$ref\":\"centralus_37\"},\"sid\":\"S-0-0-00\",\"isDomainJoined\":true,\"asset\":true,\"type\":\"account\",\"logonId\":\"0x3e7\"},{\"$id\":\"centralus_39\",\"processId\":\"0x1038\",\"commandLine\":\"\",\"host\":{\"$ref\":\"centralus_37\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_40\",\"directory\":\"c:\\\\windows\\\\inf\",\"name\":\"sample.exe\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_41\",\"processId\":\"0x1eec\",\"commandLine\":\"\",\"elevationToken\":\"Default\",\"creationTimeUtc\":\"2024-04-05T12:46:42.7621918Z\",\"imageFile\":{\"$ref\":\"centralus_40\"},\"account\":{\"$ref\":\"centralus_38\"},\"parentProcess\":{\"$ref\":\"centralus_39\"},\"host\":{\"$ref\":\"centralus_37\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_42\",\"sessionId\":\"0x3e7\",\"startTimeUtc\":\"2024-04-05T12:46:42.7621918Z\",\"endTimeUtc\":\"2024-04-05T12:46:42.7621918Z\",\"asset\":false,\"type\":\"host-logon-session\",\"host\":{\"$ref\":\"centralus_37\"},\"account\":{\"$ref\":\"centralus_38\"}},{\"$id\":\"centralus_43\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899795992378081_f96732db-2f5d-4d70-8203-00c83c673435\",\"name\":\"2516899795992378081_f96732db-2f5d-4d70-8203-00c83c673435\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Digital currency mining related behavior detected\",\"alertName\":\"SIMULATED_VM_DigitalCurrencyMining\",\"detectedTimeUtc\":\"2024-04-05T12:46:40.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of host data on Sample-VM detected the execution of a process or command normally associated with digital currency mining.\",\"remediationSteps\":\"Review with Sample-account the suspicious command process and command line to confirm that this is legitimate activity that you expect to see on Sample-VM. If not, escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"9eea8f92-2f91-6944-ba9f-383a22ca0e77\",\"extendedProperties\":{\"user Name\":\"Sample-account\",\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Servers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"Sample-VM\",\"suspicious Process\":\"sample.exe\",\"suspicious Command Line\":\"\\\\sample.exe -t 4\",\"suspicious Process Id\":\"0x1640\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"defaultresourcegroup-wus\",\"account Session Id\":\"0x427d8dd9\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.494Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_44\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"Sample-VM\",\"netBiosName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"osFamily\":\"Windows\",\"osVersion\":\"Windows\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_45\",\"processId\":\"0x1020\",\"commandLine\":\"\",\"host\":{\"$ref\":\"centralus_44\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_46\",\"name\":\"Sample-account\",\"ntDomain\":\"Sample-VM\",\"host\":{\"$ref\":\"centralus_44\"},\"sid\":\"S-1-5-21-3061399664-1673012318-3185014992-20022\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\",\"logonId\":\"0x427d8dd9\"},{\"$id\":\"centralus_47\",\"directory\":\"c:\\\\temp\",\"name\":\"sample.exe\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_48\",\"processId\":\"0x1640\",\"commandLine\":\".\\\\sample.exe -t 4\",\"elevationToken\":\"Default\",\"creationTimeUtc\":\"2024-04-05T12:46:40.7621918Z\",\"imageFile\":{\"$ref\":\"centralus_47\"},\"account\":{\"$ref\":\"centralus_46\"},\"parentProcess\":{\"$ref\":\"centralus_45\"},\"host\":{\"$ref\":\"centralus_44\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_49\",\"sessionId\":\"0x427d8dd9\",\"startTimeUtc\":\"2024-04-05T12:46:40.7621918Z\",\"endTimeUtc\":\"2024-04-05T12:46:40.7621918Z\",\"asset\":false,\"type\":\"host-logon-session\",\"host\":{\"$ref\":\"centralus_44\"},\"account\":{\"$ref\":\"centralus_46\"}},{\"$id\":\"centralus_50\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796012378081_e452fd2a-5435-46d9-b68d-bc5610e99cb6\",\"name\":\"2516899796012378081_e452fd2a-5435-46d9-b68d-bc5610e99cb6\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT]  Suspicious PHP execution detected\",\"alertName\":\"SIMULATED_VM_SuspectPhp\",\"detectedTimeUtc\":\"2024-04-05T12:46:38.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Machine logs indicate a that a suspicious PHP process is running. The action included an attempt to run OS commands or PHP code from the command line using the PHP process.\\r\\nWhile this behavior can be legitimate, in web applications this behavior is also observed in malicious activities such as attempts to infect websites with web shells.\",\"remediationSteps\":\"1. Review the command line in the alert details. If legitimate, you can ignore the alert. If not, escalate the alert to your information security team.\\r\\n2. Make sure that the web application is up-to-date.\\r\\n3. If possible, disable the sensitive PHP commands (see: http://php.net/manual/ini.core.php#ini.disable-functions).\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"16066faf-8e8c-acfb-6749-d6955fd1e9f7\",\"extendedProperties\":{\"user Name\":\"Sample-account\",\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Servers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"Sample-VM\",\"suspicious Process\":\"php\",\"suspicious Command Line\":\"php\",\"suspicious Process Id\":\"0x1e99b\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"defaultresourcegroup-wus\",\"account Session Id\":\"0xbd6e\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.541Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_51\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"Sample-VM\",\"netBiosName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"osFamily\":\"Linux\",\"osVersion\":\"Linux\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_52\",\"processId\":\"0x1e49a\",\"commandLine\":\"\",\"host\":{\"$ref\":\"centralus_51\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_53\",\"name\":\"Sample-account\",\"host\":{\"$ref\":\"centralus_51\"},\"sid\":\"\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\",\"logonId\":\"0xbd6e\"},{\"$id\":\"centralus_54\",\"directory\":\"/usr/bin\",\"name\":\"php\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_55\",\"processId\":\"0x1e99b\",\"commandLine\":\"php\",\"creationTimeUtc\":\"2024-04-05T12:46:38.7621918Z\",\"imageFile\":{\"$ref\":\"centralus_54\"},\"account\":{\"$ref\":\"centralus_53\"},\"parentProcess\":{\"$ref\":\"centralus_52\"},\"host\":{\"$ref\":\"centralus_51\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_56\",\"sessionId\":\"0xbd6e\",\"startTimeUtc\":\"2024-04-05T12:46:38.7621918Z\",\"endTimeUtc\":\"2024-04-05T12:46:38.7621918Z\",\"asset\":false,\"type\":\"host-logon-session\",\"host\":{\"$ref\":\"centralus_51\"},\"account\":{\"$ref\":\"centralus_53\"}},{\"$id\":\"centralus_57\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796032378081_c68ceb96-1e62-4cc5-a0d6-1a9d2b438262\",\"name\":\"2516899796032378081_c68ceb96-1e62-4cc5-a0d6-1a9d2b438262\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT]  Detected suspicious file cleanup commands\",\"alertName\":\"SIMULATED_VM.Windows_GoldFileCleanup\",\"detectedTimeUtc\":\"2024-04-05T12:46:36.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of host data on Sample-VM detected a combination of systeminfo commands that has previously been associated with one of activity group GOLD's methods of performing post-compromise self-cleanup activity.  While 'systeminfo.exe' is a legitimate Windows tool, executing it twice in succession, followed by a delete command in the way that has occurred here is rare.\",\"remediationSteps\":\"Review with user Sample-account the 'sample.exe executions and delete commands flagged in this alert to confirm that they are legitimate and expected on Sample-VM. If not, escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"8a3efef1-b856-e09b-eaa6-9520d38b55d5\",\"extendedProperties\":{\"user Name\":\"OMS-AGENT-2\\\\DnzmNhMdW96g7j3\",\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Servers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"OMS-AGENT-2\",\"suspicious Process\":\"c:\\\\windows\\\\system32\\\\cmd.exe\",\"suspicious Command Line\":\"cmd  /c echo \\\" systeminfo && systeminfo && del \\\"\",\"suspicious Process Id\":\"0x4a8\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"defaultresourcegroup-wus\",\"account Session Id\":\"0x12ed4a93\",\"enrichment_tas_threat__reports\":\"{\\\"Kind\\\":\\\"MultiLink\\\",\\\"DisplayValueToUrlDictionary\\\":{\\\"Report: GOLD\\\":\\\"https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2020-06-05T06%3a24%3a18&reportName=MSTI-AGP-GOLD.pdf&tenantId=7bf32e19-dc11-416d-85e8-2cff75271e2a&urlCreateDateTime=2020-06-05T06%3a24%3a18&token=%2083e9In2MDZfBKT5aMOejPcfhpNovCKiidxcnKaBGnQ=\\\"}}\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.588Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_58\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"Sample-VM\",\"netBiosName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"osFamily\":\"Windows\",\"osVersion\":\"Windows\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_59\",\"processId\":\"0x12ac\",\"commandLine\":\"\",\"host\":{\"$ref\":\"centralus_58\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_60\",\"name\":\"Sample-VM\",\"ntDomain\":\"Sample-VM\",\"host\":{\"$ref\":\"centralus_58\"},\"sid\":\"\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\",\"logonId\":\"0x12ed4a93\"},{\"$id\":\"centralus_61\",\"directory\":\"c:\\\\windows\\\\system32\",\"name\":\"cmd.exe\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_62\",\"processId\":\"0x4a8\",\"commandLine\":\"cmd  /c echo Hi\",\"elevationToken\":\"Default\",\"creationTimeUtc\":\"2024-04-05T12:46:36.7621918Z\",\"imageFile\":{\"$ref\":\"centralus_61\"},\"account\":{\"$ref\":\"centralus_60\"},\"parentProcess\":{\"$ref\":\"centralus_59\"},\"host\":{\"$ref\":\"centralus_58\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_63\",\"sessionId\":\"0x12ed4a93\",\"startTimeUtc\":\"2024-04-05T12:46:36.7621918Z\",\"endTimeUtc\":\"2024-04-05T12:46:36.7621918Z\",\"asset\":false,\"type\":\"host-logon-session\",\"host\":{\"$ref\":\"centralus_58\"},\"account\":{\"$ref\":\"centralus_60\"}},{\"$id\":\"centralus_64\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796052378081_fbb4cb47-9d5c-4861-8c13-94f13b1309d3\",\"name\":\"2516899796052378081_fbb4cb47-9d5c-4861-8c13-94f13b1309d3\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT]  Detected Petya ransomware indicators\",\"alertName\":\"SIMULATED_VM.Windows_PetyaRansomware\",\"detectedTimeUtc\":\"2024-04-05T12:46:34.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of host data on OMS-AGENT-2 detected indicators associated with Petya ransomware. See https://blogs.technet.microsoft.com/mmpc/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/ for more information. Review the command line associated in this alert and escalate this alert to your security team.\",\"remediationSteps\":\"1. Run a full anti-malware scan and verify that the threat was removed\\r\\n2. Install and run Microsoft’s Malicious Software Removal Tool (see http://www.microsoft.com/security/pc-security/malware-removal.aspx)\\r\\n3. Perform these actions pre-emptively on other hosts in your network.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"9406cd1c-d7f8-97aa-ab16-86c33b0819d3\",\"extendedProperties\":{\"user Name\":\"Sample-account\",\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Servers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"Sample-VM\",\"suspicious Process\":\"c:\\\\windows\\\\system32\\\\sample.exe\",\"suspicious Command Line\":\"sample\",\"suspicious Process Id\":\"0x1574\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"defaultresourcegroup-wus\",\"account Session Id\":\"0x12ed4a93\",\"enrichment_tas_threat__reports\":\"{\\\"Kind\\\":\\\"MultiLink\\\",\\\"DisplayValueToUrlDictionary\\\":{\\\"Report: Petya\\\":\\\"\\\"}}\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.639Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_65\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"Sample-VM\",\"netBiosName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"osFamily\":\"Windows\",\"osVersion\":\"Windows\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_66\",\"processId\":\"0x12ac\",\"commandLine\":\"\",\"host\":{\"$ref\":\"centralus_65\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_67\",\"name\":\"Sample-VM\",\"ntDomain\":\"Sample-VM\",\"host\":{\"$ref\":\"centralus_65\"},\"sid\":\"\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\",\"logonId\":\"0x12ed4a93\"},{\"$id\":\"centralus_68\",\"directory\":\"c:\\\\windows\\\\system32\",\"name\":\"sample.exe\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_69\",\"processId\":\"0x1574\",\"commandLine\":\"sample\",\"elevationToken\":\"Default\",\"creationTimeUtc\":\"2024-04-05T12:46:34.7621918Z\",\"imageFile\":{\"$ref\":\"centralus_68\"},\"account\":{\"$ref\":\"centralus_67\"},\"parentProcess\":{\"$ref\":\"centralus_66\"},\"host\":{\"$ref\":\"centralus_65\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_70\",\"sessionId\":\"0x12ed4a93\",\"startTimeUtc\":\"2024-04-05T12:46:34.7621918Z\",\"endTimeUtc\":\"2024-04-05T12:46:34.7621918Z\",\"asset\":false,\"type\":\"host-logon-session\",\"host\":{\"$ref\":\"centralus_65\"},\"account\":{\"$ref\":\"centralus_67\"}},{\"$id\":\"centralus_71\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/providers/Microsoft.Security/locations/centralus/alerts/2516899796092378081_09b90f01-f351-4a64-b4c3-ae6dd64c0176\",\"name\":\"2516899796092378081_09b90f01-f351-4a64-b4c3-ae6dd64c0176\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] MicroBurst exploitation toolkit used to extract keys to your storage accounts (Preview)\",\"alertName\":\"SIMULATED_ARM_MicroBurst.AZStorageKeysREST\",\"detectedTimeUtc\":\"2024-04-05T12:46:30.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: MicroBurst's exploitation toolkit was used to extract keys to your storage accounts. This was detected by analyzing Azure Activity logs and resource management operations in your subscription.\",\"remediationSteps\":\"1. Determine whether the activity was intentional – by contacting the account owner.\\n2. If the activity was intentional, dismiss the alert. Otherwise, treat the user account and subscription as compromised and continue with the next remediation steps.\\n3. Remediate the compromised user account: delete the user account if it's an unfamiliar account (the attacker may have created it), otherwise change its authentication credentials, use Azure Activity Logs to locate suspicious activities and review all activities performed by the user.\\n4. Remediate the compromised subscription: remove any unfamiliar Runbook from the compromised automation account, review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources and delete any unfamiliar Azure Resource, review all alerts in Azure Security Center related to the subscription and investigate them, use Azure Activity Logs to locate suspicious activities and review all activities performed in this subscription.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"subscription-id\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"e9f44a33-de08-4bea-7b60-50ed5603cc8c\",\"extendedProperties\":{\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id\",\"compromisedEntity\":\"subscription-id\",\"productComponentName\":\"Resource Manager\",\"effectiveSubscriptionId\":\"subscription-id\",\"username\":\"Sample user\",\"principalOid\":\"00000000-0000-0000-0000-000000000000\",\"ip address\":\"00.00.00.000\",\"microBurst modules\":\"Get-AZStorageKeysREST\",\"resourceType\":\"Subscription\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.884Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_72\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id\",\"resourceType\":\"Subscription\",\"resourceName\":\"subscription-id\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796112378081_8f47ec4b-cbd1-4729-b849-be7e5220acd6\",\"name\":\"2516899796112378081_8f47ec4b-cbd1-4729-b849-be7e5220acd6\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Antimalware real-time protection was disabled in your virtual machine (Preview)\",\"alertName\":\"SIMULATED_ARM_AmRealtimeProtectionDisabled\",\"detectedTimeUtc\":\"2024-04-05T12:46:28.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Real-time protection disablement of the antimalware extension was detected in your virtual machine by analyzing the Azure Resource Manager operations in your subscription.\\nAttackers might disable real-time protection from the antimalware scan on your virtual machine to avoid detection while running arbitrary code or infecting the machine with malware.\",\"remediationSteps\":\"1. Determine if the activity was intentional – by contacting the account owner.\\n2. If the activity was intentional - dismiss the alert. Otherwise, enable the antimalware real-time threat protection and treat the user account, subscription and virtual machine as compromised and continue with the next steps.\\n3. Remediate the compromised user account – change the password, review all activities performed by the user via Azure Activity Logs and locate suspicious activities\\n4. Remediate the compromised subscription - Review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources and delete any unfamiliar Azure Resource, review all alerts in Azure Security Center related to the subscription and investigate them, review all activities performed in this subscription via Azure Activity Logs and locate suspicious activities.\\n5. Remediate the compromised virtual machine – change the password of all users, run full antimalware scan on your virtual machine.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"d5e0c125-95cb-f8f2-6f77-7126e4b1928d\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Resource Manager\",\"effectiveSubscriptionId\":\"subscription-id\",\"principal object ID\":\"00000000-0000-0000-0000-000000000000\",\"principal name\":\"Sample Principal\",\"extension Name\":\"IaasAntimalware\",\"antimalware enabled\":\"true\",\"real time antimalware protection enabled\":\"false\",\"scheduled antimalware scan enabled\":\"\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.931Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_73\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_74\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"asset\":true,\"type\":\"host\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796132378081_72c3fecc-8f1b-44b3-ab3c-9d35f54d991d\",\"name\":\"2516899796132378081_72c3fecc-8f1b-44b3-ab3c-9d35f54d991d\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Custom script extension with suspicious command in your virtual machine (Preview)\",\"alertName\":\"SIMULATED_ARM_CustomScriptExtensionSuspiciousCmd\",\"detectedTimeUtc\":\"2024-04-05T12:46:26.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Custom script extension with suspicious command was detected in your virtual machine by analyzing the Azure Resource Manager operations in your subscription.\\nAttackers may use custom script extension to execute a malicious code on your virtual machine via the Azure Resource Manager.\",\"remediationSteps\":\"1. Contact the account owner to determine whether the activity was intentional. If the activity was intentional, dismiss the alert.\\n2. If the activity was unexpected, treat the user account, subscription, and virtual machine as compromised.\\n3. To remediate compromised user accounts, delete them if they’re unfamiliar (as they may have been created by a threat actor), otherwise change their authentication credentials. Use Azure Activity Logs to review all activities performed by the user and identify any that are suspicious.\\n4. To remediate compromised subscriptions, remove any unfamiliar Runbooks from the compromised automation account, review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources in the subscription (delete any that are unfamiliar), review and investigate any security alerts for the subscription in Azure Security Center, and use Azure Activity Logs to review all activities performed in the subscription and identify any that are suspicious.\\n5. To remediate the compromised virtual machine, change the passwords for all users, run a full antimalware scan on the machine, and reimage the virtual machine from a malware-free source.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"8ff1d422-c521-81cc-f98d-042fe46f8779\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Resource Manager\",\"effectiveSubscriptionId\":\"subscription-id\",\"ip address\":\"00.00.00.000\",\"principal object ID\":\"00000000-0000-0000-0000-000000000000\",\"principal name\":\"Sample user\",\"identity address\":\"\",\"suspicious command\":\"powershell.exe -ExecutionPolicy Unrestricted -File sample.ps1\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.978Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_75\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_76\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM\",\"asset\":true,\"type\":\"host\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796152378081_a304d408-2b3a-4179-bee2-da2a1f8361b4\",\"name\":\"2516899796152378081_a304d408-2b3a-4179-bee2-da2a1f8361b4\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Anonymity network activity (Preview)\",\"alertName\":\"SIMULATED_AzureDNS_DarkWeb\",\"detectedTimeUtc\":\"2024-04-05T12:46:24.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected anonymity network activity. Such activity, while possibly legitimate user behaviour, is frequently employed by attackers to evade tracking and fingerprinting of network communications. Typical related attacker activity is likely to include the download and execution of malicious software or remote administration tools.\",\"remediationSteps\":\"Ask the machine owner if this is intended behavior.\\r\\nIf the activity is unexpected, treat the machine as potentially compromised and remediate as follows.\\r\\nIsolate the machine from the network to prevent lateral movement.\\r\\nRun a full antimalware scan on the machine, following any resulting remediation advice.\\r\\nReview installed and running software on the machine, removing any unknown or unwanted packages.\\r\\nRevert the machine to a known good state, reinstalling operating system if required and restoring software from a verified malware-free source.\\r\\nResolve Azure Security Center recommendations for the machine, remediating highlighted security issues to prevent future breaches.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"4db6ebbc-1f21-03d0-9b4e-15b14ee00c9f\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"DNS\",\"effectiveSubscriptionId\":\"subscription-id\",\"domainName\":\"sample.domain\",\"answers\":\"00.00.00.00\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.681Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_77\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"sampleHost\",\"netBiosName\":\"sampleHost\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"asset\":true,\"type\":\"host\",\"containerId\":null},{\"$id\":\"centralus_78\",\"domainName\":\"sample.domain\",\"ipAdresses\":[{\"$id\":\"centralus_79\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Francisco\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0},\"asset\":false,\"type\":\"ip\"}],\"hostIpAddress\":{\"$ref\":\"centralus_79\"},\"asset\":false,\"type\":\"dns\"},{\"$ref\":\"centralus_79\"},{\"$id\":\"centralus_80\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796172378081_a0cb8f11-0dc7-4ac8-83f2-320f061c6ff2\",\"name\":\"2516899796172378081_a0cb8f11-0dc7-4ac8-83f2-320f061c6ff2\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Possible data exfiltration via DNS tunnel (Preview)\",\"alertName\":\"SIMULATED_AzureDNS_DataExfiltration\",\"detectedTimeUtc\":\"2024-04-05T12:46:22.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected a possible DNS tunnel. Such activity, while possibly legitimate user behaviour, is frequently performed by attackers to evade network monitoring and filtering. Typical related attacker activity is likely to include the download and execution of malicious software or remote administration tools.\",\"remediationSteps\":\"Ask the machine owner if this is intended behavior.\\r\\nIf the activity is unexpected, treat the machine as potentially compromised and remediate as follows.\\r\\nIsolate the machine from the network to prevent lateral movement.\\r\\nRun a full antimalware scan on the machine, following any resulting remediation advice.\\r\\nReview installed and running software on the machine, removing any unknown or unwanted packages.\\r\\nRevert the machine to a known good state, reinstalling operating system if required and restoring software from a verified malware-free source.\\r\\nResolve Azure Security Center recommendations for the machine, remediating highlighted security issues to prevent future breaches.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"bad13698-bfc5-a578-c4f8-0dc5f3488100\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"DNS\",\"effectiveSubscriptionId\":\"subscription-id\",\"domainName\":\"sample.domain\",\"answers\":\"00.00.00.00\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.728Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_81\",\"dnsDomain\":\"\",\"ntDomain\":\"\",\"hostName\":\"sampleHost\",\"netBiosName\":\"sampleHost\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"asset\":true,\"type\":\"host\",\"containerId\":null},{\"$id\":\"centralus_82\",\"domainName\":\"sample.domain\",\"ipAdresses\":[{\"$id\":\"centralus_83\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Francisco\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0},\"asset\":false,\"type\":\"ip\"}],\"hostIpAddress\":{\"$ref\":\"centralus_83\"},\"asset\":false,\"type\":\"dns\"},{\"$ref\":\"centralus_83\"},{\"$id\":\"centralus_84\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796192378081_a79fe7b4-4b55-4b78-a393-1681f896870a\",\"name\":\"2516899796192378081_a79fe7b4-4b55-4b78-a393-1681f896870a\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Communication with possible phishing domain (Preview)\",\"alertName\":\"SIMULATED_AzureDNS_PhishingDomain\",\"detectedTimeUtc\":\"2024-04-05T12:46:20.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected a request for a possible phishing domain. Such activity, while possibly benign, is frequently performed by attackers to harvest credentials to remote services. Typical related attacker activity is likely to include the exploitation of any credentials on the legitimate service.\",\"remediationSteps\":\"Investigate the domain (using whois), validating that the registration belongs to the expected owner.\\r\\nIf ownership is suspect, contact the machine owner to highlight the discrepancy and verify the degree of interaction, suggesting user log into any account(s) potentially exposed during suspicious session, validate recent activity and change compromised password(s).\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"7e41f478-9689-e8ec-71a5-d16e83e73d28\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"DNS\",\"effectiveSubscriptionId\":\"subscription-id\",\"domainName\":\"sample.domain\",\"answers\":\"00.00.00.00\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.78Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_85\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"asset\":true,\"type\":\"host\",\"containerId\":null},{\"$id\":\"centralus_86\",\"domainName\":\"sample.domain\",\"ipAdresses\":[{\"$id\":\"centralus_87\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Francisco\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0},\"asset\":false,\"type\":\"ip\"}],\"hostIpAddress\":{\"$ref\":\"centralus_87\"},\"asset\":false,\"type\":\"dns\"},{\"$ref\":\"centralus_87\"},{\"$id\":\"centralus_88\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796212378081_b04f022f-15f7-4900-a081-bb9cf6dff11b\",\"name\":\"2516899796212378081_b04f022f-15f7-4900-a081-bb9cf6dff11b\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Attempted communication with suspicious sinkholed domain (Preview)\",\"alertName\":\"SIMULATED_AzureDNS_SinkholedDomain\",\"detectedTimeUtc\":\"2024-04-05T12:46:18.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected request for sinkholed domain. Such activity, while possibly legitimate user behaviour, is frequently an indication of the download or execution of malicious software. Typical related attacker activity is likely to include the download and execution of further malicious software or remote administration tools.\",\"remediationSteps\":\"Ask the machine owner if this is intended behavior.\\r\\nIf the activity is unexpected, treat the machine as potentially compromised and remediate as follows.\\r\\nIsolate the machine from the network to prevent lateral movement.\\r\\nRun a full antimalware scan on the machine, following any resulting remediation advice.\\r\\nReview installed and running software on the machine, removing any unknown or unwanted packages.\\r\\nRevert the machine to a known good state, reinstalling operating system if required and restoring software from a verified malware-free source.\\r\\nResolve Azure Security Center recommendations for the machine, remediating highlighted security issues to prevent future breaches.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"349a9a96-2576-6142-94d6-e03225e5ad13\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"DNS\",\"effectiveSubscriptionId\":\"subscription-id\",\"domainName\":\"sample.domain\",\"answers\":\"00.00.00.00\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.842Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_89\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"asset\":true,\"type\":\"host\",\"containerId\":null},{\"$id\":\"centralus_90\",\"domainName\":\"sample.domain\",\"ipAdresses\":[{\"$id\":\"centralus_91\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Francisco\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0},\"asset\":false,\"type\":\"ip\"}],\"hostIpAddress\":{\"$ref\":\"centralus_91\"},\"asset\":false,\"type\":\"dns\"},{\"$ref\":\"centralus_91\"},{\"$id\":\"centralus_92\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796232690621_84e0019d-f7c9-460c-8ffe-187ce8eaff98\",\"name\":\"2516899796232690621_84e0019d-f7c9-460c-8ffe-187ce8eaff98\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Attempt to run high privilege command detected\",\"alertName\":\"SIMULATED_AppServices_HighPrivilegeCommand\",\"detectedTimeUtc\":\"2024-04-05T12:46:16.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of App Service processes detected an attempt to run a command that requires high privileges.\",\"remediationSteps\":\"1. Review the command line in the alert details. If legitimate, you can ignore the alert. If not, escalate the alert to your information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"e79605b4-303a-ec0a-0107-b426e4a26b1e\",\"extendedProperties\":{\"user Name\":\"Sample-account\",\"resourceType\":\"App Service\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"App Service\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"Sample-VM\",\"suspicious Process\":\"sample.exe\",\"suspicious Command Line\":\"sample.exe\",\"parent Process\":\"sample.exe\",\"suspicious Process Id\":\"0x4680\",\"account Session Id\":\"0x15c0644\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.233Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_93\",\"processId\":\"0x39a8\",\"commandLine\":\"\",\"imageFile\":{\"$id\":\"centralus_94\",\"directory\":\"sample\",\"name\":\"sample.exe\",\"asset\":false,\"type\":\"file\"},\"asset\":false,\"type\":\"process\"},{\"$ref\":\"centralus_94\"},{\"$id\":\"centralus_95\",\"processId\":\"0x4680\",\"commandLine\":\"sample.exe\",\"elevationToken\":\"Default\",\"creationTimeUtc\":\"2024-04-05T12:46:16.7309378Z\",\"imageFile\":{\"$ref\":\"centralus_94\"},\"parentProcess\":{\"$ref\":\"centralus_93\"},\"asset\":false,\"type\":\"process\"},{\"$id\":\"centralus_96\",\"resourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Web/sites/Sample-App\",\"resourceType\":\"App Service\",\"resourceName\":\"Sample-App\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796252690621_785f80a3-70d5-4955-aa8d-ff191ca3a8bb\",\"name\":\"2516899796252690621_785f80a3-70d5-4955-aa8d-ff191ca3a8bb\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Dangling DNS record for an App Service resource detected\",\"alertName\":\"SIMULATED_AppServices_DanglingDomain\",\"detectedTimeUtc\":\"2024-04-05T12:46:14.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: A DNS record that points to a recently deleted App Service resource (also known as \\\"dangling DNS\\\" entry) has been detected. This leaves you susceptible to a subdomain takeover. Subdomain takeovers enable malicious actors to redirect traffic intended for an organization’s domain to a site performing malicious activity.\",\"remediationSteps\":\"From your DNS zone, remove all CNAME records that point to the deleted App Service resource.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-App\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"6c6bb1db-ff4b-bb91-de18-8fa03a39d68e\",\"extendedProperties\":{\"resourceType\":\"App Service\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app\",\"compromisedEntity\":\"Sample-App\",\"productComponentName\":\"App Service\",\"effectiveSubscriptionId\":\"subscription-id\",\"domain\":\"sample-domain.com\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.275Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_97\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app\",\"resourceType\":\"App Service\",\"resourceName\":\"Sample-app\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796272690621_0b3d7a2a-3a6d-4d34-9af9-18b8f40237d2\",\"name\":\"2516899796272690621_0b3d7a2a-3a6d-4d34-9af9-18b8f40237d2\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Digital currency mining related behavior detected\",\"alertName\":\"SIMULATED_K8S_NODE_DigitalCurrencyMining\",\"detectedTimeUtc\":\"2024-04-05T12:46:12.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of processes running within a container or directly on a Kubernetes node, has detected an execution of a process or command normally associated with digital currency mining.\",\"remediationSteps\":\"Review with the specified user the suspicious command process and command line to confirm that this is legitimate activity. If not, escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Cluster\",\"associatedResource\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.ContainerService/ManagedClusters/Sample-Cluster\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c9bc91a9-5080-9414-d878-47ca43fc8cb5\",\"extendedProperties\":{\"resourceType\":\"Kubernetes Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.ContainerService/ManagedClusters/Sample-Cluster\",\"compromisedEntity\":\"Sample-Cluster\",\"productComponentName\":\"Containers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"AKS-AGENTPOOL-00171883-vmss000000\",\"suspicious Process\":\"/tmp/gcc\",\"suspicious Command Line\":\"/tmp/gcc -T -o stratum+tcp://stratum.slushpool:3333 -u foobar -p baz -o stratum+tcp://stratum.f2pool.com:3333 -u foobar -p baz -o stratum+tcp://stratum.antpool.com:3333 -u foobar -p baz\",\"parent Process\":\"bash\",\"suspicious Process Id\":\"0x2dc8\",\"imageName\":\":\",\"process Origin\":\"Pod Container\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.76Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_98\",\"resourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.ContainerService/ManagedClusters/Sample-Cluster\",\"resourceType\":\"Kubernetes Service\",\"resourceName\":\"Sample-Cluster\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_99\",\"name\":\"sample-cluster\",\"cloudResource\":{\"$ref\":\"centralus_98\"},\"friendlyName\":\"sample-cluster\",\"asset\":false,\"type\":\"K8s-cluster\"},{\"$id\":\"centralus_100\",\"imageId\":\"sample-image:v1\",\"friendlyName\":\"sample-image:v1\",\"asset\":false,\"type\":\"container-image\"},{\"$id\":\"centralus_101\",\"containerId\":\"cc8ec8580f4c\",\"image\":{\"$ref\":\"centralus_100\"},\"friendlyName\":\"cc8ec8580f4c\",\"asset\":false,\"type\":\"container\"},{\"$id\":\"centralus_102\",\"directory\":\"\",\"name\":\"bash\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_103\",\"directory\":\"/tmp\",\"name\":\"gcc\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_104\",\"hostName\":\"aks-agentpool-00171883-vmss000000\",\"netBiosName\":\"aks-agentpool-00171883-vmss000000\",\"osFamily\":\"Linux\",\"osVersion\":\"Linux\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_105\",\"processId\":\"0x2dc8\",\"commandLine\":\"/tmp/gcc -T -o stratum+tcp://stratum.slushpool:3333 -u foobar -p baz -o stratum+tcp://stratum.f2pool.com:3333 -u foobar -p baz -o stratum+tcp://stratum.antpool.com:3333 -u foobar -p baz\",\"creationTimeUtc\":\"2024-04-05T12:46:12.7309378Z\",\"imageFile\":{\"$ref\":\"centralus_103\"},\"parentProcess\":{\"$id\":\"centralus_106\",\"isValid\":false,\"asset\":false,\"type\":\"process\"},\"host\":{\"$ref\":\"centralus_104\"},\"asset\":false,\"type\":\"process\"},{\"$ref\":\"centralus_106\"},{\"$id\":\"centralus_107\",\"processId\":\"0x2dc3\",\"commandLine\":\"\",\"imageFile\":{\"$id\":\"centralus_108\",\"isValid\":false,\"asset\":false,\"type\":\"file\"},\"host\":{\"$ref\":\"centralus_104\"},\"asset\":false,\"type\":\"process\"},{\"$ref\":\"centralus_108\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796292690621_51cfba05-0fcb-4b20-b259-a07e3739e521\",\"name\":\"2516899796292690621_51cfba05-0fcb-4b20-b259-a07e3739e521\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access to cloud metadata service detected (Preview)\",\"alertName\":\"SIMULATED_K8S_NODE_ImdsCall\",\"detectedTimeUtc\":\"2024-04-05T12:46:10.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of processes running within a container detected access to the cloud metadata service for acquiring identity token. The container doesn't normally perform such operation. While this behavior might be legitimate, attackers might use this technique to access cloud resources after gaining initial access to a running container.\",\"remediationSteps\":\"Review the command line in the alert details. If the container should acquire identity tokens, you can ignore the alert.\\r\\nIf this behavior isnt expected, escalate the alert to your information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Cluster\",\"associatedResource\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/AWS-Master-Connector_012345678901/securityentitydata/aws-eks-cluster-sample-cluster-ap-us-east-2\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"7eff77fc-9649-6863-ab72-432161a83f2a\",\"extendedProperties\":{\"resourceType\":\"AWS EKS Cluster\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/AWS-Master-Connector_012345678901/securityentitydata/aws-eks-cluster-sample-cluster-ap-us-east-2\",\"compromisedEntity\":\"Sample-Cluster\",\"productComponentName\":\"Containers\",\"effectiveSubscriptionId\":\"subscription-id\",\"username\":\"sample-user\",\"process Name\":\"/usr/bin/curl\",\"command\":\"curl -s -H Metadata: true http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https%3A%2F%2Fvault.azure.net\",\"process Id\":\"18775\",\"container ID\":\"cc8ec8580f4c\",\"image Name\":\"sample-image:v1\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.811Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_109\",\"imageId\":\"sample-image:v1\",\"friendlyName\":\"sample-image:v1\",\"asset\":false,\"type\":\"container-image\"},{\"$id\":\"centralus_110\",\"containerId\":\"cc8ec8580f4c\",\"image\":{\"$ref\":\"centralus_109\"},\"friendlyName\":\"cc8ec8580f4c\",\"asset\":false,\"type\":\"container\"},{\"$id\":\"centralus_111\",\"amazonResourceId\":\"arn:aws:eks:us-east-2:012345678901:cluster/sample-cluster\",\"amazonAccountId\":\"012345678901\",\"resourceType\":\"AWS EKS Cluster\",\"resourceName\":\"sample-cluster\",\"friendlyName\":\"sample-cluster\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"amazon-resources\",\"entityIds\":[{\"Type\":\"MdcConnectorResourceAzureId\",\"Id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/AWS-Master-Connector_012345678901/securityentitydata/aws-eks-cluster-sample-cluster-ap-us-east-2\"}],\"relatedAzureResourceIds\":{\"MulticloudResourceMDCAzureId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/AWS-Master-Connector_012345678901/securityentitydata/aws-eks-cluster-sample-cluster-ap-us-east-2\",\"MdcConnectorResourceAzureId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/AWS-Master-Connector_012345678901/securityentitydata/aws-eks-cluster-sample-cluster-ap-us-east-2\"}}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796312690621_db03475e-c2c4-4b6a-8b4b-415339bbab53\",\"name\":\"2516899796312690621_db03475e-c2c4-4b6a-8b4b-415339bbab53\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Security-related process termination detected (Preview)\",\"alertName\":\"SIMULATED_K8S_NODE_SuspectProcessTermination\",\"detectedTimeUtc\":\"2024-04-05T12:46:08.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Analysis of processes running within a container or directly on a Kubernetes node, has detected an attempt to terminate processes related to security monitoring on the container. Attackers will often try to terminate such processes using predefined scripts post-compromise.\",\"remediationSteps\":\"Review and confirm that this was legitimate activity that you expect to see on this container or pod. If not, escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-Cluster\",\"associatedResource\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"d6ade331-ad30-4be2-2193-3e2a8755585f\",\"extendedProperties\":{\"user Name\":\"root\",\"resourceType\":\"GCP GKE Cluster\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"compromisedEntity\":\"Sample-Cluster\",\"productComponentName\":\"Containers\",\"effectiveSubscriptionId\":\"subscription-id\",\"compromised Host\":\"aks-agentpool-00171883-vmss000000\",\"suspicious Process\":\"/usr/bin/pkill\",\"suspicious Command Line\":\"/usr/bin/pkill -KILL -x -U 0 auoms\",\"parent Process\":\"auomsctl\",\"suspicious Process Id\":\"0x2dc8\",\"process Origin\":\"Kubernetes Node\",\"account Session Id\":\"0xd5a\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.853Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_112\",\"name\":\"sample-cluster\",\"cloudResource\":{\"$id\":\"centralus_113\",\"resourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"resourceType\":\"GCP GKE Cluster\",\"resourceName\":\"gcp-clusters-sample-cluster-us-central1-c\",\"type\":\"azure-resource\"},\"friendlyName\":\"sample-cluster\",\"asset\":false,\"type\":\"K8s-cluster\"},{\"$ref\":\"centralus_113\"},{\"$id\":\"centralus_114\",\"hostName\":\"aks-agentpool-00171883-vmss000000\",\"netBiosName\":\"aks-agentpool-00171883-vmss000000\",\"osFamily\":\"Linux\",\"osVersion\":\"Linux\",\"asset\":false,\"type\":\"host\",\"containerId\":\"cc8ec8580f4c\"},{\"$id\":\"centralus_115\",\"directory\":\"/usr/bin\",\"name\":\"pkill\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_116\",\"directory\":\"\",\"name\":\"auomsctl\",\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_117\",\"processId\":\"0x2dc3\",\"commandLine\":\"\",\"imageFile\":{\"$id\":\"centralus_118\",\"isValid\":false,\"asset\":false,\"type\":\"file\"},\"host\":{\"$ref\":\"centralus_114\"},\"asset\":false,\"type\":\"process\"},{\"$ref\":\"centralus_118\"},{\"$id\":\"centralus_119\",\"name\":\"root\",\"isDomainJoined\":false,\"isValid\":false,\"id\":\"3418\",\"asset\":false,\"type\":\"account\"},{\"$id\":\"centralus_120\",\"processId\":\"0x2dc8\",\"commandLine\":\"/usr/bin/pkill -KILL -x -U 0 auoms\",\"creationTimeUtc\":\"2024-04-05T12:46:12.7309378Z\",\"imageFile\":{\"$ref\":\"centralus_115\"},\"account\":{\"$ref\":\"centralus_119\"},\"parentProcess\":{\"$id\":\"centralus_121\",\"isValid\":false,\"asset\":false,\"type\":\"process\"},\"host\":{\"$ref\":\"centralus_114\"},\"asset\":false,\"type\":\"process\"},{\"$ref\":\"centralus_121\"},{\"$id\":\"centralus_122\",\"fullResourceName\":\"//container.googleapis.com/projects/012345678901/zones/us-central1-c/clusters/Sample-Cluster\",\"projectId\":\"012345678901\",\"resourceType\":\"GCP GKE Cluster\",\"resourceName\":\"Sample-Cluster\",\"location\":\"us-central1-c\",\"locationType\":\"Zonal\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"gcp-resource\",\"entityIds\":[{\"Type\":\"MdcConnectorResourceAzureId\",\"Id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\"}],\"relatedAzureResourceIds\":{\"MulticloudResourceMDCAzureId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\",\"MdcConnectorResourceAzureId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/securityConnectors/gcp-connector/securityentitydata/gcp-clusters-sample-cluster-us-central1-c\"}}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796332690621_d0f561bc-1dbd-44a0-98a0-676fda7bb209\",\"name\":\"2516899796332690621_d0f561bc-1dbd-44a0-98a0-676fda7bb209\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Exposed Kubernetes dashboard detected (Preview)\",\"alertName\":\"SIMULATED_K8S_ExposedDashboard\",\"detectedTimeUtc\":\"2024-04-05T12:46:06.7309378Z\",\"description\":\"THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected exposure of the Kubernetes Dashboard by a LoadBalancer service.\\nExposed dashboard allows an unauthenticated access to the cluster management and poses a security threat.\",\"remediationSteps\":\"Review the LoadBalancer service in the alert details. In case the dashboard is exposed to the Internet, delete the LoadBalancer service immediately and escalate the alert to the information security team.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Cluster\",\"associatedResource\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-Cluster\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c0a56820-e9a7-2101-58ce-b9d078b383d4\",\"extendedProperties\":{\"resourceType\":\"Kubernetes - Azure Arc\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-Cluster\",\"compromisedEntity\":\"Sample-Cluster\",\"productComponentName\":\"Containers\",\"effectiveSubscriptionId\":\"subscription-id\",\"username\":\"alias@domain.com\",\"namespace\":\"kubernetes-dashboard\",\"service name\":\"kubernetes-dashboard\",\"port\":\"443\",\"target port\":\"8443\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:23.717Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_123\",\"resourceId\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-Cluster\",\"resourceType\":\"Kubernetes - Azure Arc\",\"resourceName\":\"Sample-Cluster\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_124\",\"cloudResource\":{\"$ref\":\"centralus_123\"},\"asset\":false,\"type\":\"K8s-cluster\"},{\"$id\":\"centralus_125\",\"name\":\"kubernetes-dashboard\",\"cluster\":{\"$ref\":\"centralus_124\"},\"friendlyName\":\"kubernetes-dashboard\",\"asset\":false,\"type\":\"K8s-namespace\"},{\"$id\":\"centralus_126\",\"name\":\"kubernetes-dashboard\",\"namespace\":{\"$ref\":\"centralus_125\"},\"friendlyName\":\"kubernetes-dashboard/kubernetes-dashboard\",\"asset\":false,\"type\":\"K8s-service\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796352378081_85a7af67-46cb-4a9d-b0de-80b5d898bf77\",\"name\":\"2516899796352378081_85a7af67-46cb-4a9d-b0de-80b5d898bf77\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspected successful brute force attack\",\"alertName\":\"SIMULATED_SQL.VM_BruteForce\",\"detectedTimeUtc\":\"2024-04-05T12:46:04.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: A successful login occurred after an apparent brute force attack on your resource\",\"remediationSteps\":\"Go to the firewall settings in order to lock down the firewall as tightly as possible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"dcbedfd9-2bcf-4d43-a77b-34947e342d78\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"Sample-RG\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"client IP address\":\"00.00.00.00\",\"client principal name\":\"Sample-account\",\"client application\":\"Sample-app\",\"potential causes\":\"Brute force attack; penetration testing.\",\"client IP location\":\"san antonio, united states\",\"failed logins\":\"0\",\"successful logins\":\"1\",\"oms workspace ID\":\"00000000-0000-0000-0000-000000000000\",\"oms agent ID\":\"00000000-0000-0000-0000-000000000000\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.228Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_127\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000000\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_128\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"sample\",\"countryName\":\"united states\",\"state\":\"texas\",\"city\":\"san antonio\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"sample\",\"organization\":\"sample-organization\",\"organizationType\":\"sample-organization\",\"cloudProvider\":\"Azure\",\"systemService\":\"sample\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_129\",\"sourceAddress\":{\"$ref\":\"centralus_128\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_130\",\"name\":\"Sample-SA\",\"host\":{\"$ref\":\"centralus_127\"},\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_131\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796372378081_73dd54d4-3633-47b4-bfdc-f6baf4983cf5\",\"name\":\"2516899796372378081_73dd54d4-3633-47b4-bfdc-f6baf4983cf5\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Potential SQL Injection\",\"alertName\":\"SIMULATED_SQL.VM_PotentialSqlInjection\",\"detectedTimeUtc\":\"2024-04-05T12:46:02.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Potential SQL Injection was detected on your database Sample-DB on server Sample-VM\",\"remediationSteps\":\"{\\\"displayValue\\\":\\\"Read more about SQL Injection threats and best practices for safe application code.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2106894\\\"}\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"73885a8e-f74c-b2ef-f59b-02aeedb522b0\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"Sample-RG\",\"alert Id\":\"00000000-0000-0000-0000-000000000001\",\"client IP address\":\"00.00.00.00\",\"client principal name\":\"Sample-user\",\"client application\":\"Sample-app\",\"potential causes\":\"Defect in application code constructing faulty SQL statements; application code doesn't sanitize user input and was exploited to inject malicious SQL statements\",\"threat ID\":\"1\",\"vulnerable statement\":\"*** Anonymized ***\",\"client IP location\":\"Sample\",\"oms workspace ID\":\"00000000-0000-0000-0000-00000000001\",\"oms agent ID\":\"00000000-0000-0000-0000-000000000001\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.275Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_132\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_133\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"sample\",\"countryName\":\"united states\",\"state\":\"texas\",\"city\":\"san antonio\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"sample\",\"organization\":\"sample-organization\",\"organizationType\":\"sample-organization\",\"cloudProvider\":\"Azure\",\"systemService\":\"sample\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_134\",\"sourceAddress\":{\"$ref\":\"centralus_133\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_135\",\"name\":\"Sample-SA\",\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_136\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796392378081_6d78b5e6-3131-44ca-8ec0-a51b3a97b9af\",\"name\":\"2516899796392378081_6d78b5e6-3131-44ca-8ec0-a51b3a97b9af\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Attempted logon by a potentially harmful application\",\"alertName\":\"SIMULATED_SQL.VM_HarmfulApplication\",\"detectedTimeUtc\":\"2024-04-05T12:46:00.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: A potentially harmful application attempted to access your resource.\",\"remediationSteps\":\"Go to the firewall settings in order to lock down the firewall as tightly as possible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"a7f4437b-8b0d-5b26-0982-381b6c1c9d6c\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"Sample-RG\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"client IP address\":\"00.00.00.00\",\"client principal name\":\"Sample-user\",\"client application\":\"Sample-app\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"How to investigate this alert using logs at your Log Analytics workspace.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2091064\\\"}\",\"potential causes\":\"Penetration testing; malicious activity\",\"successful Logins from potentially harmful application\":\"1\",\"client IP location\":\"Sample\",\"oms workspace ID\":\"00000000-0000-0000-0000-000000000001\",\"oms agent ID\":\"00000000-0000-0000-0000-000000000001\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.327Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_137\",\"hostName\":\"Sample-VM\",\"azureID\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_138\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"sample\",\"countryName\":\"united states\",\"state\":\"texas\",\"city\":\"san antonio\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"sample\",\"organization\":\"sample-organization\",\"organizationType\":\"sample-organization\",\"cloudProvider\":\"Azure\",\"systemService\":\"sample\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_139\",\"sourceAddress\":{\"$ref\":\"centralus_138\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_140\",\"name\":\"Sample-SA\",\"host\":{\"$ref\":\"centralus_137\"},\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_141\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796412378081_8314a2fa-96fc-4b2f-aeb4-f5f05d9c0fb3\",\"name\":\"2516899796412378081_8314a2fa-96fc-4b2f-aeb4-f5f05d9c0fb3\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Login from a suspicious IP\",\"alertName\":\"SIMULATED_SQL.VM_SuspiciousIpAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:58.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Your resource has been accessed successfully from an IP address that Microsoft Threat Intelligence has associated with suspicious activity.\",\"remediationSteps\":\"Go to the firewall settings in order to lock down the firewall as tightly as possible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-VM\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"02ec8361-fbdf-39b5-3f35-f11266927cf4\",\"extendedProperties\":{\"resourceType\":\"Virtual Machine\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"compromisedEntity\":\"Sample-VM\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"workspaceSubscriptionId\":\"00000000-0000-0000-0000-000000000001\",\"workspaceResourceGroup\":\"Sample-RG\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"client IP address\":\"00.00.00.00\",\"client principal name\":\"Sample-user\",\"client application\":\"Sample-app\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"How to investigate this alert using logs at your Log Analytics workspace.\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2091064\\\"}\",\"potential causes\":\"An attacker has accessed your database from a potentially suspicious IP; a legitimate user has accessed your database from a potentially suspicious IP.\",\"client IP location\":\"Sample\",\"oms workspace ID\":\"00000000-0000-0000-0000-000000000001\",\"oms agent ID\":\"00000000-0000-0000-0000-000000000001\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.373Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_142\",\"hostName\":\"Sample-VM\",\"azureID\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"omsAgentID\":\"00000000-0000-0000-0000-000000000001\",\"asset\":true,\"type\":\"host\"},{\"$id\":\"centralus_143\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"sample\",\"countryName\":\"united states\",\"state\":\"texas\",\"city\":\"san antonio\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"sample\",\"organization\":\"sample-organization\",\"organizationType\":\"sample-organization\",\"cloudProvider\":\"Azure\",\"systemService\":\"sample\"},\"threatIntelligence\":[{\"providerName\":\"Sample-Provider\",\"threatType\":\"Sample-Threat\",\"threatName\":\"Sample-Threat\",\"confidence\":0.8,\"threatDescription\":\"Sample-Threat\"}],\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_144\",\"sourceAddress\":{\"$ref\":\"centralus_143\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_145\",\"name\":\"Sample-SA\",\"host\":{\"$ref\":\"centralus_142\"},\"isDomainJoined\":false,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_146\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM\",\"resourceType\":\"Virtual Machine\",\"resourceName\":\"Sample-VM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/providers/Microsoft.Security/locations/centralus/alerts/2516899796432378081_aee3232b-9ae4-4bff-b2b1-f88e1bd593df\",\"name\":\"2516899796432378081_aee3232b-9ae4-4bff-b2b1-f88e1bd593df\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Permissions granted for an RBAC role in an unusual way for your Azure environment (Preview)\",\"alertName\":\"SIMULATED_ARM_AnomalousRBACRoleAssignment\",\"detectedTimeUtc\":\"2024-04-05T12:45:56.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Azure Defender for Resource Manager detected an RBAC role assignment that's unusual when compared with other assignments, performed by the same assigner.\\n The following components were anomalous:\\n -Assigner Authentication Method \\n This operation might have been performed by a legitimate user in your organization. Alternatively, it might indicate that an account in your organization was breached, and that the threat actor is trying to grant permissions to an additional user account they own.\",\"remediationSteps\":\"1. To determine whether this was a legitimate operation performed by the actual account owner, contact the account owner of the assigner.\\n2. If the activity is legitimate, dismiss this alert. Otherwise, treat the user accounts of the assigner and assignee as compromised and continue with the steps below.\\n3. Change the passwords of the accounts of the assigner and assignee, or block the user accounts entirely.\\n4. Using Azure Activity Logs and Azure AD audit logs, review all activities performed by the user. \\n5. Change the credentials for all resources that the user had permissions to access.\\n6. Treat the resource as compromised and perform remediation actions: review IAM permissions for the resource and remove permissions for any unfamiliar user account, review all Azure Security Center alerts related to the resource and investigate them, review all activities performed in this resource via Azure Activity Logs and investigate suspicious activities.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"subscription-id\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"f6e41d3f-546e-5973-b41e-a719c19415f8\",\"extendedProperties\":{\"resourceType\":\"Subscription\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id\",\"compromisedEntity\":\"subscription-id\",\"productComponentName\":\"Other\",\"effectiveSubscriptionId\":\"subscription-id\",\"assigner principal ID\":\"Sample user\",\"assignee principal ID\":\"00000000-0000-0000-0000-000000000000\",\"assigned role definition ID\":\"00000000-0000-0000-0000-000000000000\",\"scope of assignment\":\"/SUBSCRIPTIONS/subscription-id\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.025Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_147\",\"name\":\"Sample user\",\"upnSuffix\":\"sample\",\"aadTenantId\":\"00000000-0000-0000-0000-000000000000\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":true,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_148\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id\",\"resourceType\":\"Subscription\",\"resourceName\":\"subscription-id\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_149\",\"address\":\"00.00.00.00\",\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_150\",\"sourceAddress\":{\"$ref\":\"centralus_149\"},\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/providers/Microsoft.Security/locations/centralus/alerts/2516899796452378081_0ce449c8-6a97-4586-bef9-3edc7b6de26b\",\"name\":\"2516899796452378081_0ce449c8-6a97-4586-bef9-3edc7b6de26b\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Privileged custom role created for your subscription in a suspicious way (Preview)\",\"alertName\":\"SIMULATED_ARM_PrivilegedRoleDefinitionCreation\",\"detectedTimeUtc\":\"2024-04-05T12:45:54.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Azure Defender for Resource Manager detected a suspicious creation of privileged custom role definition in your subscription. This operation might have been performed by a legitimate user in your organization. Alternatively, it might indicate that an account in your organization was breached, and that the threat actor is trying to create a privileged role to use in the future to evade detection.\",\"remediationSteps\":\"1. To determine whether this was a legitimate operation performed by the actual account owner, contact the account owner of the principal user that created the role.\\n2. If the activity is legitimate, dismiss this alert. Otherwise, treat the user account as compromised and continue with the steps below.\\n3. Change the passwords of the user account or block the account entirely.\\n4. Delete the privileged role.\\n5. Using Azure Activity Logs and Azure AD audit logs, review all activities performed by the user.\\n6. Change the credentials for all resources that the user had permissions to access.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"subscription-id\",\"associatedResource\":\"/SUBSCRIPTIONS/subscription-id\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"fc8ce318-1a8d-377d-e5c4-e2d03e67a3ab\",\"extendedProperties\":{\"resourceType\":\"Subscription\",\"effectiveAzureResourceId\":\"/SUBSCRIPTIONS/subscription-id\",\"compromisedEntity\":\"subscription-id\",\"productComponentName\":\"Other\",\"effectiveSubscriptionId\":\"subscription-id\",\"role definition creator principal ID\":\"00000000-0000-0000-0000-000000000000\",\"role definition creator IP address\":\"0.0.0.0\",\"role definition creator principal name\":\"Sample user\",\"role definition name\":\"sample\",\"role definition ID\":\"00000000-0000-0000-0000-000000000000\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.077Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_151\",\"name\":\"Sample user\",\"upnSuffix\":\"sample\",\"aadTenantId\":\"00000000-0000-0000-0000-000000000000\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":true,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_152\",\"resourceId\":\"/SUBSCRIPTIONS/subscription-id\",\"resourceType\":\"Subscription\",\"resourceName\":\"subscription-id\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/providers/Microsoft.Security/locations/centralus/alerts/2516899796512378081_47482034-ed80-4083-aa8d-b1e928d1780b\",\"name\":\"2516899796512378081_47482034-ed80-4083-aa8d-b1e928d1780b\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Permissions granted for a classic role in an unusual way for your Azure environment (Preview)\",\"alertName\":\"SIMULATED_ARM_AnomalousClassicRoleAssignment\",\"detectedTimeUtc\":\"2024-04-05T12:45:48.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Microsoft Defender for Resource Manager detected a role assignment that's unusual when compared with other assignments performed by the same assigner / performed for the same assignee / in the tenant due to the following anomalies: \\nassignment time, assigner location, assigner, authentication method, assigned entities, client software used, assignment extent. \\nThis operation might have been performed by a legitimate user in your organization. Alternatively, it might indicate that an account in your organization was breached, and that the threat actor is trying to escalate privileges to a different user account.\",\"remediationSteps\":\"1.To determine whether this was a legitimate operation performed by the actual account owner, contact the account owner of the assigner.\\n2. If the activity is legitimate, dismiss this alert. Otherwise, treat the user accounts of the assigner and assignee as compromised and continue with the steps below. \\n3. Change the passwords of the accounts of the assigner and assignee, or block the user accounts entirely.\\n4. Using Azure Activity Logs and Azure AD audit logs, review all activities performed by the user.\\n5. Change the credentials for all resources that the user had permissions to access. \\n6. Treat the resource as compromised and perform remediation actions: review IAM permissions for the resource and remove permissions for any unfamiliar user account, review all Azure Security Center alerts related to the resource and investigate them, review Azure Activity Logs for activities performed in this resource.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"subscription-id\",\"associatedResource\":\"/subscriptions/subscription-id\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"2f89227f-2ee7-4892-7691-2e8b240660bb\",\"extendedProperties\":{\"resourceType\":\"Subscription\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id\",\"compromisedEntity\":\"subscription-id\",\"productComponentName\":\"Other\",\"effectiveSubscriptionId\":\"subscription-id\",\"assigner principal ID\":\"sample\",\"assignee principal ID\":\"00000000-0000-0000-0000-000000000000\",\"scope of assignment\":\"/subscriptions/subscription-id\",\"role\":\"CoAdmin\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.166Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_153\",\"resourceId\":\"/subscriptions/subscription-id\",\"resourceType\":\"Subscription\",\"resourceName\":\"subscription-id\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_154\",\"name\":\"sample\",\"upnSuffix\":\"contoso.com\",\"aadTenantId\":\"00000000-0000-0000-0000-000000000000\",\"aadUserId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":true,\"asset\":true,\"type\":\"account\"},{\"$id\":\"centralus_155\",\"address\":\"00.00.00.00\",\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_156\",\"sourceAddress\":{\"$ref\":\"centralus_155\"},\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_157\",\"name\":\"azureadmin\",\"upnSuffix\":\"contoso.com\",\"aadTenantId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":true,\"asset\":true,\"type\":\"account\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796552534930_d355e7a4-3899-403c-a280-2c57886daf70\",\"name\":\"2516899796552534930_d355e7a4-3899-403c-a280-2c57886daf70\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a Tor exit node to a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_TorAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:44.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: An IP that is a known Tor exit node accessed Storage file share 'Sample-fileShare' in storage account 'Sample-Storage'. \",\"remediationSteps\":\"• Revoke all credentials that may be compromised and ensure that they're only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"f95708eb-dc82-2996-86f5-cfdf2b9beef2\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Check if this actor is legitimate. Examine the authentication method and credentials used, as well as the actor's history of actions on this storage account and other resources in this subscription.\\r\\n• Limit access to your storage account, following the 'least privilege' principle: https://go.microsoft.com/fwlink/?linkid=2075737.\",\"potential causes\":\"This alert indicates that this account has been accessed successfully from an IP address that is known as an active exit node of Tor (an anonymizing proxy). The severity of this alert takes into account the authentication type used (if any), and whether this is the first case of such access.\\r\\nPotential causes:\\r\\n• An attacker has accessed the storage account using Tor and is trying to hide their identity (true positive).\\r\\n• A legitimate user has accessed the storage account using Tor, perhaps for penetration testing (benign positive).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetFile\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"0 Bytes\",\"file share\":\"Sample-fileShare\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.389Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_158\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_159\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_160\",\"sourceAddress\":{\"$ref\":\"centralus_159\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796572534930_0ab269cf-4235-45ea-a1cf-34979b6757a7\",\"name\":\"2516899796572534930_0ab269cf-4235-45ea-a1cf-34979b6757a7\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a suspicious IP to a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_SuspiciousIp\",\"detectedTimeUtc\":\"2024-04-05T12:45:42.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from a suspicious IP address.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"53bb9f3b-b728-62a8-a652-a06a9701126a\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that this account has been accessed successfully from an IP address that is considered suspicious.\\r\\nPotential causes:\\r\\n• An attacker has accessed your storage account from a potentially suspicious IP.\\r\\n• A legitimate user has accessed your storage account from a potentially suspicious IP.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetFile\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"0 Bytes\",\"file share\":\"Sample-fileShare\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.342Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_161\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_162\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"threatIntelligence\":[{\"providerName\":\"AlertSimulator\",\"threatType\":\"Sample-Type\",\"threatName\":\"Sample-Threat\",\"confidence\":1.0,\"threatDescription\":\"\"}],\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_163\",\"sourceAddress\":{\"$ref\":\"centralus_162\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796632534930_b8e3c41c-dc4a-442b-9cf0-00f9ad051e58\",\"name\":\"2516899796632534930_b8e3c41c-dc4a-442b-9cf0-00f9ad051e58\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Potential malware uploaded to a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_MalwareHashReputation\",\"detectedTimeUtc\":\"2024-04-05T12:45:36.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has uploaded potential malware to your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Remove the malicious file from your storage account.\\r\\n• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"04878553-dc29-1d8b-28c6-7ad800d5c596\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that a blob containing potential malware has been uploaded to your storage account.\\r\\nPotential causes:\\r\\n• An attacker has gained access to the storage account and has intentionally uploaded a malicious blob.\\r\\n• A legitimate user has unintentionally uploaded a malicious blob.\\r\\n• A legitimate user is performing tests on the system (e.g. penetration testing).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"PutRange\",\"malware description\":\"File was identified as malicious, MalwareFamily = Virus:DOS/EICAR_Test_File\",\"detection source\":\"Team Cymru\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"file\":\"dummy/path/to/maliciousFile.exe\",\"file share\":\"Sample-fileShare\",\"threat report summary\":\"The European Institute for Computer Antivirus Research (EICAR)  and the Computer Antivirus Research Organization (CARO)  jointly developed a standard test file protocol called the “EICAR test file” which allows users to test their antivirus solution. The EICAR file is completely benign; however, when scanned, compliant antivirus solutions report the file in the same way as an actual malicious file. This does not mean that the computer is infected with malware, but rather it shows that the computer’s antivirus is functioning as expected.\",\"threat report\":\"Sample-Report\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.28Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_164\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_165\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_166\",\"sourceAddress\":{\"$ref\":\"centralus_165\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_167\",\"directory\":\"Sample-fileShare/dummy/path/to\",\"name\":\"Sample-Name\",\"fileHashes\":[{\"$id\":\"centralus_168\",\"algorithm\":\"MD5\",\"value\":\"65a8e27d8877183831b664bd8b7f0ad4\",\"friendlyName\":\"MD5/65a8e27d8877183831b664bd8b7f0ad4\",\"asset\":false,\"type\":\"filehash\"}],\"asset\":false,\"type\":\"file\"},{\"$ref\":\"centralus_168\"},{\"$id\":\"centralus_169\",\"name\":\"Sample-Name\",\"category\":\"Virus\",\"files\":[{\"$ref\":\"centralus_167\"}],\"asset\":false,\"type\":\"malware\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796652534930_de7186ac-179d-4d19-857e-a1867cf640d0\",\"name\":\"2516899796652534930_de7186ac-179d-4d19-857e-a1867cf640d0\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from an unusual location to a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_GeoAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:34.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from an unusual location.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"0c40a430-29c5-0bdc-3d66-d3027f63c2e5\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that this account has been accessed successfully from an IP address that is unfamiliar and unexpected compared to recent access pattern on this account.\\r\\nPotential causes:\\r\\n• An attacker has accessed your storage account.\\r\\n• A legitimate user has accessed your storage account from a new location.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetShareProperties\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"file share\":\"Sample-fileShare\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.228Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_170\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_171\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_172\",\"sourceAddress\":{\"$ref\":\"centralus_171\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796692534930_aeb856af-c220-414a-8f02-61852c772fa7\",\"name\":\"2516899796692534930_aeb856af-c220-414a-8f02-61852c772fa7\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual deletion in a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_DeletionAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:30.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has performed an unusual deletion in your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c91f193d-9911-2194-8f23-b5931dbb3792\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the data deletion was intended based on information provided above such as IP address, location and user agent used.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that one or more unexpected delete operations has occurred in a storage account, compared to recent activity on this account.\\r\\nPotential causes:\\r\\n• An attacker has deleted data from your storage account.\\r\\n• A legitimate user has performed an unusual deletion.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"access key used to generate SAS token\":\"key1\",\"file share\":\"Sample-fileShare\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"DeleteFile\",\"storage file path(s) deleted\":\"Sample-File1, Sample-File2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.181Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_173\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_174\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_175\",\"sourceAddress\":{\"$ref\":\"centralus_174\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796712534930_8cd7bd40-dd65-47bc-8f97-d42befd78179\",\"name\":\"2516899796712534930_8cd7bd40-dd65-47bc-8f97-d42befd78179\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual data exploration in a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_DataExplorationAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:28.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has performed an unusual data exploration operation in your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"e4eacfd7-0cc5-346b-60ec-860a7974f2d6\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that files in a file share of a storage account have been enumerated in an unusual way, compared to recent activity on this account.\\r\\nPotential causes:\\r\\n• An attacker has performed reconnaissance for a future attack.\\r\\n• A legitimate user or application logic has explored data within the storage account.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Account key\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"file share\":\"Sample-fileShare\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"ListFiles\",\"access key used\":\"key2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.139Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_176\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_177\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_178\",\"sourceAddress\":{\"$ref\":\"centralus_177\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796732534930_4cec03d3-db66-4c00-8f30-35803bf0d861\",\"name\":\"2516899796732534930_4cec03d3-db66-4c00-8f30-35803bf0d861\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual number of files extracted from a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_DataExfiltration.NumberOfFilesAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:26.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has extracted an unusual number of files from your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"b0e441db-1c8f-9b5d-0675-2b104c5aadc0\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that an unusually large number of files has been extracted compared to recent activity on this Storage file share.\\r\\nPotential causes:\\r\\n• An attacker has extracted a large number of files from a Storage file share (for example: data exfiltration/breach, unauthorized transfer of data).\\r\\n• A legitimate user or application has extracted an unusual number of files from a Storage file share (for example: maintenance activity).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetFile\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"5 MB\",\"file share\":\"Sample-fileShare\",\"extracted files\":\"150\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.092Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_179\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_180\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_181\",\"sourceAddress\":{\"$ref\":\"centralus_180\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796752534930_8b51ade2-868d-4cb0-9f1d-63bb7c3930a9\",\"name\":\"2516899796752534930_8b51ade2-868d-4cb0-9f1d-63bb7c3930a9\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual amount of data extracted from a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_DataExfiltration.AmountOfDataAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:24.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has extracted an unusual amount of data from your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"26f60a1e-57cd-81af-d178-e86f14918e76\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that an unusually large amount of data has been extracted compared to recent activity on this Storage file share.\\r\\nPotential causes:\\r\\n• An attacker has extracted a large amount of data from a Storage file share (for example: data exfiltration/breach, unauthorized transfer of data).\\r\\n• A legitimate user or application has extracted an unusual amount of data from a Storage file share (for example: maintenance activity).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetFile\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"150 MB\",\"file share\":\"Sample-fileShare\",\"extracted files\":\"5\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:25.04Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_182\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_183\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_184\",\"sourceAddress\":{\"$ref\":\"centralus_183\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796772534930_a76e7850-8aa7-4d70-875f-318dd3965a38\",\"name\":\"2516899796772534930_a76e7850-8aa7-4d70-875f-318dd3965a38\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual application accessed a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_ApplicationAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:22.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' using an unexpected application.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"386433a8-7526-d718-8be1-56379cf1cb8a\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that an unusual application has accessed this storage account.\\r\\nPotential causes:\\r\\n• An attacker has accessed your storage account using a new application.\\r\\n• A legitimate user has used a new application/browser to access your storage account.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Account key\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"file share\":\"Sample-fileShare\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"CreateFile\",\"access key used\":\"key2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.993Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_185\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_186\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_187\",\"sourceAddress\":{\"$ref\":\"centralus_186\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796792534930_a5e98819-2471-4344-bbee-f02c77fb376c\",\"name\":\"2516899796792534930_a5e98819-2471-4344-bbee-f02c77fb376c\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual access inspection in a storage file share\",\"alertName\":\"SIMULATED_Storage.Files_AccessInspectionAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:20.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has performed an unusual access inspection in your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"eee5ab94-9cbd-724f-dc91-c768ce1356f7\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the access policy inspection was performed for a legitimate purpose: https://docs.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy.\\r\\n• Review the file share's access permissions to make sure they are expected. The permissions can be viewed and updated through the Azure Portal or Azure Storage Explorer.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that the access permissions of a storage account have been inspected in an unusual way, compared to recent activity on this account.\\r\\nPotential causes:\\r\\n• An attacker has performed reconnaissance for a future attack.\\r\\n• A legitimate user has performed maintenance on the storage account.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Files REST\",\"authentication type\":\"Shared access signature (SAS)\",\"service type\":\"Azure Files\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"access key used to generate SAS token\":\"key1\",\"file share\":\"Sample-fileShare\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"GetShareAcl\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.952Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_188\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_189\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_190\",\"sourceAddress\":{\"$ref\":\"centralus_189\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796812534930_6b0ddbf1-ea4b-4d5f-b7db-2adcfc8cfba4\",\"name\":\"2516899796812534930_6b0ddbf1-ea4b-4d5f-b7db-2adcfc8cfba4\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a Tor exit node to a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_TorAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:18.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: An IP that is a known Tor exit node accessed Storage container 'Sample-Container' in storage account 'Sample-Storage'.  This alert was triggered by an ADLS Gen2 transaction.\",\"remediationSteps\":\"• Revoke all credentials that may be compromised and ensure that they're only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"8568ee68-fa57-ddb1-f903-a5e7915d8a47\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Check if this actor is legitimate. Examine the authentication method and credentials used, as well as the actor's history of actions on this storage account and other resources in this subscription.\\r\\n• Limit access to your storage account, following the 'least privilege' principle: https://go.microsoft.com/fwlink/?linkid=2075737.\",\"potential causes\":\"This alert indicates that this account has been accessed successfully from an IP address that is known as an active exit node of Tor (an anonymizing proxy). The severity of this alert takes into account the authentication type used (if any), and whether this is the first case of such access.\\r\\nPotential causes:\\r\\n• An attacker has accessed the storage account using Tor and is trying to hide their identity (true positive).\\r\\n• A legitimate user has accessed the storage account using Tor, perhaps for penetration testing (benign positive).\",\"user agent\":\"Sample-Agent\",\"api type\":\"ADLS Gen2\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"CreatePathDir\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"0 Bytes\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.869Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_191\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_192\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_193\",\"sourceAddress\":{\"$ref\":\"centralus_192\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_194\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_191\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796832534930_f0d14560-1de4-407a-89ef-3494b6cf2563\",\"name\":\"2516899796832534930_f0d14560-1de4-407a-89ef-3494b6cf2563\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a suspicious IP to a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_SuspiciousIp\",\"detectedTimeUtc\":\"2024-04-05T12:45:16.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from a suspicious IP address.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"67d6d089-b2f6-bf2e-dbf3-9027fd24b19a\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that this account has been accessed successfully from an IP address that is considered suspicious.\\r\\nPotential causes:\\r\\n• An attacker has accessed your storage account from a potentially suspicious IP.\\r\\n• A legitimate user has accessed your storage account from a potentially suspicious IP.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetBlob\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"335.88 KB\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.827Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_195\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_196\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"threatIntelligence\":[{\"providerName\":\"AlertSimulator\",\"threatType\":\"Sample-Type\",\"threatName\":\"Sample-Threat\",\"confidence\":1.0,\"threatDescription\":\"\"}],\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_197\",\"sourceAddress\":{\"$ref\":\"centralus_196\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796852534930_a463b66b-15f7-4261-8339-120227dfbb05\",\"name\":\"2516899796852534930_a463b66b-15f7-4261-8339-120227dfbb05\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] PREVIEW - Access from a suspicious application \",\"alertName\":\"SIMULATED_Storage.Blob_SuspiciousApplication\",\"detectedTimeUtc\":\"2024-04-05T12:45:14.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: There was a failed attempt to anonymously access the blob container `Sample-Container` in your storage account `Sample-Storage`. This might indicate that an attacker is trying to exploit a vulnerability or access data in your storage account, or it could be the result of a penetration test carried out in your organization. The suspicious application detected was `eicarDummyApp`. For more details, please see the user-agent string in the alert fields. In many cases, attackers might successfully access data after a series of failed attempts. It’s therefore important to act on this alert.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"83832449-f3ac-d367-5098-ea3620bd0d6d\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Anonymous\",\"operations types\":\"GetBlob\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"140 MB\",\"application name \":\"eicarDummyApp\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.76Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_198\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_199\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_200\",\"sourceAddress\":{\"$ref\":\"centralus_199\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_201\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_198\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796912534930_61b08b72-2956-404f-a265-f45a83bb3f69\",\"name\":\"2516899796912534930_61b08b72-2956-404f-a265-f45a83bb3f69\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Publicly accessible storage containers successfully discovered\",\"alertName\":\"SIMULATED_Storage.Blob_OpenContainersScanning.SuccessfulDiscovery\",\"detectedTimeUtc\":\"2024-04-05T12:45:08.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: A successful discovery of 3 publicly open storage containers in storage account 'Sample-Storage' was performed in the last hour by a scanning script or tool.\\r\\n\\r\\nScanned containers include: static, images, backups.\\r\\n\\r\\nThis usually indicates a reconnaissance attack, where the threat actor tries to list blobs by guessing container names, in the hope of finding misconfigured open storagecontainers with sensitive data in them.\\r\\nThe threat actor may use their own script or use known scanning tools like Microburst to scan for publicly open containers.\\r\\n\\r\\nAfter a threat actor successfully discovers a container, they usually continue by reading and exfiltrating the data.\",\"remediationSteps\":\"• Where applicable, we recommend to configure authenticated access to blob containers using Azure AD roles or shared access signature tokens.\\r\\n• If you have a legitimate reason for these containers to remain publicly accessible, verify that they do not contain sensitive data. Additionally, ensure that users with write permissions are aware that the uploaded data will be publicly accessible.\\r\\n• When allowing anonymous access to containers, consider adding a random suffix to its name (or use a randomly generated name) to limit these types of scans in the future. For example, use 'salesshare-4536-7836-8967'.\\r\\n• If this is a recurring alert from the same IP, consider blocking the source IP address (see how to block an IP address: https://go.microsoft.com/fwlink/?linkid=2179709).\\r\\nThis can be done at the storage account level using the 'networking' configuration or at the subscription level using the networking 'access restrictions' configuration.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"94b40a0d-c3ce-c1c2-e5f4-46354b944d89\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Check this account for publicly open containers with sensitive data. If such containers exist, immediately change their access policy to private (see how to change your access policy: https://go.microsoft.com/fwlink/?linkid=2179708).\\r\\n\\r\\nLook at diagnostic logs to see all sensitive data that may have leaked, and escalate the alert and information.\\r\\n• To list all containers that are publicly accessible in a storage account, use the PowerShell script in this link: https://go.microsoft.com/fwlink/?linkid=2180103.\\r\\n\\r\\n• Check whether the user that performed this scan is legitimate. Look at IP, location, user agent, and their history.\\r\\n• This alert may be triggered by a coding issue in the application accessing the storage container. If you've validated that the actor is legitimate, identified the coding issue, and ruled out a possible leak of sensitive content, this alert can be considered benign.\",\"potential causes\":\"• Reconnaisance attack (True Positive)\\r\\n• Penetration testing\\r\\n• A bug in an application is causing it to perform serial attempts to read different blobs (False Positive).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Anonymous\",\"operations types\":\"GetBlob\",\"service type\":\"Azure Blobs\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"140 MB\",\"number of failed access attempts\":\"1232\",\"among the enumeration terms used\":\"erp, exe, export, exports, file, files, firmware, git, img, iso, jenkins, logs, media, mobile, photos, pics, private, prod, production, products, projects, public, release, repo, reports, resources, script, scripts, services, snapshots, source, src, staging, stats, storage, tenant, tmp, upload, uploads, user, userdata, users, usr, vhd, vhdx, video, videos, web, www, xslx\",\"number of containers successfully accessed\":\"3\",\"list of containers successfully accessed\":\"Sample-1, Sample-2, Sample-3\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.713Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_202\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_203\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_204\",\"sourceAddress\":{\"$ref\":\"centralus_203\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_205\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_202\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796932534930_88477856-b3b8-4e8b-b0cc-9b13c34384e6\",\"name\":\"2516899796932534930_88477856-b3b8-4e8b-b0cc-9b13c34384e6\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Publicly accessible storage containers unsuccessfully scanned\",\"alertName\":\"SIMULATED_Storage.Blob_OpenContainersScanning.FailedAttempt\",\"detectedTimeUtc\":\"2024-04-05T12:45:06.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: 1232 failed attempts to scan for publicly open storage containers in storage account 'Sample-Storage' were performed in the last hour.\\r\\n\\r\\nScanned containers include: erp, exe, export, exports, file.\\r\\n\\r\\nThis usually indicates a reconnaissance attack, where the threat actor tries to list blobs by guessing container names, in the hope of finding misconfigured open storage containers with sensitive data in them.\\r\\nThe threat actor may use their own script or use known scanning tools like Microburst to scan for publicly open containers.\",\"remediationSteps\":\"• Where applicable, we recommend to configure authenticated access to blob containers using Azure AD roles or shared access signature tokens.\\r\\n• If you have a legitimate reason for these containers to remain publicly accessible, verify that they do not contain sensitive data. Additionally, ensure that users with write permissions are aware that the uploaded data will be publicly accessible.\\r\\n• When allowing anonymous access to containers, consider adding a random suffix to its name (or use a randomly generated name) to limit these types of scans in the future. For example, use 'salesshare-4536-7836-8967'.\\r\\n• If this is a recurring alert from the same IP, consider blocking the source IP address (see how to block an IP address: https://go.microsoft.com/fwlink/?linkid=2179709).\\r\\nThis can be done at the storage account level using the 'networking' configuration or at the subscription level using the networking 'access restrictions' configuration.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"f43a7c21-d5ed-cc82-1a8b-ecdbbd239f7a\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Check this account for publicly open containers with sensitive data. If such containers exist, immediately change their access policy to private (see how to change your access policy: https://go.microsoft.com/fwlink/?linkid=2179708).\\r\\n\\r\\nThis is necessary despite the fact that the observed attempts failed, because reconnaissance has taken place and there might have been some successful activity.\\r\\n• To list all containers that are publicly accessible in a storage account, use the PowerShell script in this link: https://go.microsoft.com/fwlink/?linkid=2180103.\\r\\n\\r\\n• Check whether the user that performed the scanning is legitimate. Look at IP, location, user agent, and their history. Scanning operations read blob URIs and/or use \\\"list blobs\\\".\\r\\n• Check whether data was exfiltrated from containers in this storage account and/or by this actor.\\r\\n• This alert may be triggered by a coding issue in the application accessing the storage container. If you've validated that the actor is legitimate, identified the coding issue, and ruled out a possible leak of sensitive content, this alert can be considered benign.\",\"potential causes\":\"• Reconnaisance attack (True Positive)\\r\\n• Penetration testing\\r\\n• A bug in an application is causing it to perform serial attempts to read different blobs (False Positive).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Anonymous\",\"operations types\":\"GetBlob\",\"service type\":\"Azure Blobs\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"number of failed access attempts\":\"1232\",\"among the enumeration terms used\":\"erp, exe, export, exports, file, files, firmware, git, img, iso, jenkins, logs, media, mobile, photos, pics, private, prod, production, products, projects, public, release, repo, reports, resources, script, scripts, services, snapshots, source, src, staging, stats, storage, tenant, tmp, upload, uploads, user, userdata, users, usr, vhd, vhdx, video, videos, web, www, xslx\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.666Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_206\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_207\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_208\",\"sourceAddress\":{\"$ref\":\"centralus_207\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796952534930_f93648fb-f371-46ce-80eb-a6f3621e401c\",\"name\":\"2516899796952534930_f93648fb-f371-46ce-80eb-a6f3621e401c\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Storage account with potentially sensitive data has been detected with a publicly exposed container\",\"alertName\":\"SIMULATED_Storage.Blob_OpenACL\",\"detectedTimeUtc\":\"2024-04-05T12:45:04.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: The access policy of a container in your storage account was modified to allow anonymous access. This might lead to a data breach if the container holds any sensitive data. This alert is based on analysis of Azure activity log.\",\"remediationSteps\":\"• Check the access level of the container listed in the alert details. If the access level is set to 'anonymous' and this behavior is not intended, change the access level to 'private' and escalate the alert to your information security team.\\r\\n• Where possible, we recommend using shared access signature tokens instead of granting public access to storage containers and blobs.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"eb006fa7-9887-602b-60c1-7cc3bdbe08f4\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"container name\":\"Sample-Container\",\"sensitive name\":\"Sample-Container\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.618Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_209\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796972534930_7ec345a3-5526-4e62-8085-20ea408c2bb9\",\"name\":\"2516899796972534930_7ec345a3-5526-4e62-8085-20ea408c2bb9\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Potential malware uploaded to a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_MalwareHashReputation\",\"detectedTimeUtc\":\"2024-04-05T12:45:02.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has uploaded potential malware to your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Remove the malicious blob from your storage account.\\r\\n• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"77c2d32b-8942-f346-2212-5dd3b929f4c7\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that a blob containing potential malware has been uploaded to your storage account.\\r\\nPotential causes:\\r\\n• An attacker has gained access to the storage account and has intentionally uploaded a malicious blob.\\r\\n• A legitimate user has unintentionally uploaded a malicious blob.\\r\\n• A legitimate user is performing tests on the system (e.g. penetration testing).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Account key\",\"operations types\":\"PutBlob\",\"malware description\":\"Indicator related to a known malware campaign\",\"detection source\":\"A Microsoft Partner\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"blob\":\"Sample-Blob\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.577Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_210\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_211\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_212\",\"sourceAddress\":{\"$ref\":\"centralus_211\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_213\",\"directory\":\"Sample-fileShare/dummy/path/to\",\"name\":\"Sample-Name\",\"fileHashes\":[{\"$id\":\"centralus_214\",\"algorithm\":\"MD5\",\"value\":\"65a8e27d8877183831b664bd8b7f0ad4\",\"friendlyName\":\"MD5/65a8e27d8877183831b664bd8b7f0ad4\",\"asset\":false,\"type\":\"filehash\"}],\"asset\":false,\"type\":\"file\"},{\"$ref\":\"centralus_214\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899796992534930_908dcb2f-2d0b-4759-b65f-4cce365c9626\",\"name\":\"2516899796992534930_908dcb2f-2d0b-4759-b65f-4cce365c9626\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from an unusual location to a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_GeoAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:45:00.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from an unusual location.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"223efacb-e49b-ff9b-126d-830543d3e4c1\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that this account has been accessed successfully from an IP address that is unfamiliar and unexpected compared to recent access pattern on this account.\\r\\nPotential causes:\\r\\n• An attacker has accessed your storage account.\\r\\n• A legitimate user has accessed your storage account from a new location.\",\"azure AD application ID\":\"00000000-0000-0000-0000-000000000000\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Azure AD\",\"operations types\":\"GetContainerProperties\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"client location\":\"Sample-Location\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.53Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_215\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_216\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_217\",\"sourceAddress\":{\"$ref\":\"centralus_216\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_218\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_215\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"},{\"$id\":\"centralus_219\",\"aadTenantId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":true,\"objectGuid\":\"00000000-0000-0000-0000-000000000000\",\"isValid\":false,\"asset\":true,\"type\":\"account\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797032534930_bda32921-761b-472a-a4d1-fb6bcc8a8f6e\",\"name\":\"2516899797032534930_bda32921-761b-472a-a4d1-fb6bcc8a8f6e\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual deletion in a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_DeletionAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:56.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has performed an unusual deletion in your Azure storage account 'Sample-Storage'. This alert was triggered by an ADLS Gen2 transaction.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\\r\\n• Perform an undelete if the delete operation was a soft delete. See how to configure soft deletion and more information: https://go.microsoft.com/fwlink/?linkid=2078042\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"7aeed6a6-538d-cc32-928d-f655dd2341fa\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the data deletion was intended based on information provided above such as IP address, location and user agent used.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that one or more unexpected delete operations has occurred in a storage account, compared to recent activity on this account.\\r\\nPotential causes:\\r\\n• An attacker has deleted data from your storage account.\\r\\n• A legitimate user has performed an unusual deletion.\",\"user agent\":\"Sample-Agent\",\"api type\":\"ADLS Gen2\",\"authentication type\":\"Account key\",\"service type\":\"Azure Blobs\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"DeleteDirectory\",\"storage file path(s) deleted\":\"Sample-File1, Sample-File2\",\"access key used\":\"key2\",\"containers\":\"Sample-Container1, Sample-Container2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.462Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_220\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_221\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_222\",\"sourceAddress\":{\"$ref\":\"centralus_221\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797052534930_b92005ac-8605-4cd3-9d71-f491e5594ea7\",\"name\":\"2516899797052534930_b92005ac-8605-4cd3-9d71-f491e5594ea7\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual data exploration in a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_DataExplorationAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:54.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has performed an unusual data exploration operation in your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"5aedc4db-dc57-f573-14af-a525a14895d2\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that blobs or containers in a storage account have been enumerated in an unusual way, compared to recent activity on this account.\\r\\nPotential causes:\\r\\n• An attacker has performed reconnaissance for a future attack.\\r\\n• A legitimate user or application logic has explored data within the storage account.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Account key\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"ListBlobs\",\"access key used\":\"key2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.415Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_223\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_224\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_225\",\"sourceAddress\":{\"$ref\":\"centralus_224\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797072534930_f92c7fce-541d-455e-89cd-512b24167ca4\",\"name\":\"2516899797072534930_f92c7fce-541d-455e-89cd-512b24167ca4\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual number of blobs extracted from a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_DataExfiltration.NumberOfBlobsAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:52.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has extracted an unusual number of blobs from your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"92de77a1-454e-1e96-ac2b-322269078161\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that an unusually large number of blobs has been extracted compared to recent activity on this Storage container.\\r\\nPotential causes:\\r\\n• An attacker has extracted a large number of blobs from a Storage container (for example: data exfiltration/breach, unauthorized transfer of data).\\r\\n• A legitimate user or application has extracted an unusual number of blobs from a Storage container (for example: maintenance activity).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Account key\",\"operations types\":\"GetBlob\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"66.58 MB\",\"extracted blobs\":\"41084\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.353Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_226\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_227\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_228\",\"sourceAddress\":{\"$ref\":\"centralus_227\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_229\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_226\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797092534930_7de2868b-9c7c-472f-8b09-86826198754b\",\"name\":\"2516899797092534930_7de2868b-9c7c-472f-8b09-86826198754b\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual amount of data extracted from a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_DataExfiltration.AmountOfDataAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:50.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has extracted an unusual amount of data from your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Low\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"5f71b0ac-7092-6d71-6376-50d13fb7b1e5\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"{\\\"displayValue\\\":\\\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\\\",\\\"kind\\\":\\\"Link\\\",\\\"value\\\":\\\"https:\\\\/\\\\/go.microsoft.com\\\\/fwlink\\\\/?linkid=2075734\\\"}\",\"potential causes\":\"This alert indicates that an unusually large amount of data has been extracted compared to recent activity on this Storage container.\\r\\nPotential causes:\\r\\n• An attacker has extracted a large amount of data from a Storage container (for example: data exfiltration/breach, unauthorized transfer of data).\\r\\n• A legitimate user or application has extracted an unusual amount of data from a Storage container (for example: maintenance activity).\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Shared access signature (SAS)\",\"operations types\":\"GetBlob\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"254.47 MB\",\"extracted blobs\":\"2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.311Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_230\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_231\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_232\",\"sourceAddress\":{\"$ref\":\"centralus_231\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_233\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_230\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797132534930_9ab9061f-1745-47b0-be66-4d1982b305d2\",\"name\":\"2516899797132534930_9ab9061f-1745-47b0-be66-4d1982b305d2\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual application accessed a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_ApplicationAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:46.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' using an unexpected application.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"58a7850c-f963-bf50-6222-30b22db68ef8\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that an unusual application has accessed this storage account.\\r\\nPotential causes:\\r\\n• An attacker has accessed your storage account using a new application.\\r\\n• A legitimate user has used a new application/browser to access your storage account.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Account key\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"PutBlob\",\"access key used\":\"key2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.259Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_234\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_235\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_236\",\"sourceAddress\":{\"$ref\":\"centralus_235\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797152534930_d682e2f7-529c-4a3e-ad88-2e5cba0395e0\",\"name\":\"2516899797152534930_d682e2f7-529c-4a3e-ad88-2e5cba0395e0\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unauthenticated access to a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_AnonymousAccessAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:44.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Container 'Sample-Container' in storage account 'Sample-Storage' from an IP address located in Azure Data Center: Central Us.\\r\\n\\r\\nThere may have been additional unauthenticated access to this storage account.\",\"remediationSteps\":\"• Where applicable, we recommend to configure authenticated access to blob containers using Azure AD roles or shared access signature tokens.\\r\\n• If you have a legitimate reason for these containers to remain publicly accessible, verify that they do not contain sensitive data. Additionally, ensure that users with write permissions are aware that the uploaded data will be publicly accessible.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"fecf917a-f429-c5e5-a5a1-33baf8af7fd5\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Check if you have sensitive data on this publicly open container. If you do, immediately change the access policy to private, review diagnostic logs for sensitive data that may have leaked, and escalate the alert and information. (see how to change your access policy: https://go.microsoft.com/fwlink/?linkid=2179708)).\\r\\n\\r\\nThis is necessary despite the fact that the observed attempts failed, because reconnaissance has taken place and there might have been some successful activity.\\r\\n• Check if this actor is legitimate. Review IP, location, user agent, and their history.\",\"potential causes\":\"This alert indicates that this account has been accessed anonymously (i.e. without any authentication), which is unexpected compared to recent access pattern on this account.\\r\\nPotential causes:\\r\\n• An attacker has exploited public read access to a container.\\r\\n• A legitimate user or application has used public read access to a container.\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Anonymous\",\"operations types\":\"GetBlobProperties, GetBlob\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"azure AD user\":\"N/A (Azure AD user authentication was not used)\",\"client location\":\"Sample-Location\",\"size of extracted data\":\"22.96 MB\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.212Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_237\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_238\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_239\",\"sourceAddress\":{\"$ref\":\"centralus_238\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_240\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_237\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797172534930_6d1bedaa-1201-41e2-b2a1-98a64d4b727c\",\"name\":\"2516899797172534930_6d1bedaa-1201-41e2-b2a1-98a64d4b727c\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual access inspection in a storage blob container\",\"alertName\":\"SIMULATED_Storage.Blob_AccessInspectionAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:42.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: Someone has performed an unusual access inspection in your Azure storage account 'Sample-Storage'.\",\"remediationSteps\":\"• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.\\r\\n• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.\\r\\n• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"dade87e1-0d85-9d22-439a-d3c92bba6c72\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Confirm whether the access policy inspection was performed for a legitimate purpose: https://docs.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy.\\r\\n• Review the storage container's access permissions to make sure they are expected. The permissions can be viewed and updated through the Azure Portal or Azure Storage Explorer.\\r\\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734\",\"potential causes\":\"This alert indicates that the access permissions of a storage account have been inspected in an unusual way, compared to recent activity on this account.\\r\\nPotential causes:\\r\\n• An attacker has performed reconnaissance for a future attack.\\r\\n• A legitimate user has performed maintenance on the storage account.\",\"azure AD application ID\":\"00000000-0000-0000-0000-000000000000\",\"user agent\":\"Sample-Agent\",\"api type\":\"Blob\",\"authentication type\":\"Azure AD\",\"service type\":\"Azure Blobs\",\"container\":\"Sample-Container\",\"client location\":\"Sample-Location\",\"additional Information\":\"Sample-Additional-Information\",\"request status\":\"Success\",\"activity type\":\"GetContainerACL\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.155Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_241\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_242\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_243\",\"sourceAddress\":{\"$ref\":\"centralus_242\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"},{\"$id\":\"centralus_244\",\"aadTenantId\":\"00000000-0000-0000-0000-000000000000\",\"isDomainJoined\":true,\"objectGuid\":\"00000000-0000-0000-0000-000000000000\",\"isValid\":false,\"asset\":true,\"type\":\"account\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797192534930_d8a76409-fdcb-41f5-ad7b-ef6611fdb38e\",\"name\":\"2516899797192534930_d8a76409-fdcb-41f5-ad7b-ef6611fdb38e\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Malicious file uploaded to storage account\",\"alertName\":\"SIMULATED_Storage.Blob_AM.MalwareFound\",\"detectedTimeUtc\":\"2024-04-05T12:44:40.7465069Z\",\"description\":\"THIS IS A SAMPLE ALERT: A malicious file was uploaded to your storage account 'Sample-Storage'.\\r\\nThe malware detection is based on Microsoft antimalware scanning.\\r\\nPotential causes may include an intentional upload of malware by a threat actor, or an unintentional upload of a malicious file by a legitimate user.\",\"remediationSteps\":\"Remove the malicious blob from your storage account. You may move it to a designated storage container for quarantine, or delete it.\\r\\nIt is advisable to enable \\\\\\\"soft delete\\\\\\\" before deleting malware, to support the ability to undo the deletion. Learn more about enabling soft delete on Azure storage: https://docs.microsoft.com/azure/storage/blobs/soft-delete-blob-overview.\\\",\\\"If you have diagnostic logs enabled, query them to see if any other applications or users accessed this file. Trace their actions and contain the blast radius.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-Storage\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"848e7bdd-0194-83c6-1148-eca4465585fd\",\"extendedProperties\":{\"resourceType\":\"Storage Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"compromisedEntity\":\"Sample-Storage\",\"productComponentName\":\"Storage\",\"effectiveSubscriptionId\":\"subscription-id\",\"shA-256\":\"a591a6d40bf420404a01g833cfb7b630d62c65bf0bcda32b57b277d9ad9f146e\",\"potential Causes\":\"1. Intentional upload of malware by a malicious actor (true positive)\\r\\n\\r\\n2. Unintentional upload of malware by a legitimate user (true positive)\\r\\n\\r\\n3. A false positive detection by Microsoft antimalware scanning. You can submit a file for analysis if you suspect it may be a false positive: \\r\\n(https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/submission-guide)\",\"malware types detected\":\"DOS/EICAR_Test_File\",\"investigation Steps\":\"• Learn more about the malware type by reading the report on the identified malware in Microsoft Security Intelligence:\\r\\n(https ://www.microsoft.com/wdsi/threats/threat-search?query=DOS/EICAR_Test_File)\\r\\n\\r\\n• If you have diagnostic logs enabled, go to them and query to see if any other applications or users accessed this file. Trace their actions and contain the blast radius.\\r\\n\\r\\n• Review the credentials used to perform the upload, to track back and find the user who uploaded the file.\\r\\n\\r\\n• If you performed an investigation and suspect the this might be a false positive, you can submit a file for analysis\\r\\n(https://docs.microsoft.com/windows/security/threat-protection/intelligence/submission-guide).\\r\\nEnsure you enter the provider name \\\"Defender for Storage\\\".\\r\\n\\r\\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:24.092Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_245\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage\",\"resourceType\":\"Storage Account\",\"resourceName\":\"Sample-Storage\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_246\",\"name\":\"Sample-Name\",\"storageResource\":{\"$ref\":\"centralus_245\"},\"friendlyName\":\"Sample-Name\",\"asset\":false,\"type\":\"blob-container\"},{\"$id\":\"centralus_247\",\"algorithm\":\"SHA256\",\"value\":\"a591a6d40bf420404a01g833cfb7b630d62c65bf0bcda32b57b277d9ad9f146e\",\"friendlyName\":\"SHA256/a591a6d40bf420404a01g833cfb7b630d62c65bf0bcda32b57b277d9ad9f146e\",\"asset\":false,\"type\":\"filehash\"},{\"$id\":\"centralus_248\",\"name\":\"Sample-Name\",\"blobContainer\":{\"$ref\":\"centralus_246\"},\"url\":\"https://Sample-Storage.blob.core.windows.net/Sample/Sample.txt\",\"etag\":\"Sample-Tag\",\"friendlyName\":\"Sample-Name/Sample-Name\",\"asset\":false,\"type\":\"blob\"},{\"$id\":\"centralus_249\",\"directory\":\"https://Sample-Storage.blob.core.windows.net/Sample\",\"name\":\"Sample-Name\",\"fileHashes\":[{\"$ref\":\"centralus_247\"}],\"asset\":false,\"type\":\"file\"},{\"$id\":\"centralus_250\",\"name\":\"Sample-Name\",\"category\":\"Virus\",\"files\":[{\"$ref\":\"centralus_249\"}],\"asset\":false,\"type\":\"malware\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797232378081_2a0775b1-1cb2-4184-857f-d07be308b5d0\",\"name\":\"2516899797232378081_2a0775b1-1cb2-4184-857f-d07be308b5d0\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a Tor exit node\",\"alertName\":\"SIMULATED_AzureCosmosDB_TorAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:36.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Azure Cosmos DB account 'Sample-AzureCosmosDBAccount' was successfully accessed from an IP address known to be an active exit node of Tor, an anonymizing proxy.\\r\\nThe threat actor's access was authenticated using Aad.\\r\\nAuthenticated access from a Tor exit node is a likely indication that a threat actor is trying to hide their identity.\",\"remediationSteps\":\"• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.\\r\\n• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.\\r\\n• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"304f2e43-2711-cd1b-3e81-52f95ff5f15c\",\"extendedProperties\":{\"resourceType\":\"Azure Cosmos DB Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Verify whether this user is legitimate. Review the credentials used and user's history of actions on this resource and others.\\r\\n• Check for credential theft by reviewing the authentication method.\",\"potential causes\":\"• A legitimate user has accessed your Azure Cosmos DB account using Tor.\",\"user agent\":\"dummyAgent\",\"container name\":\"Sample-Container\",\"database name\":\"Sample-Database\",\"key type\":\"Aad\",\"connection mode\":\"Gateway\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.76Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_251\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_252\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_253\",\"sourceAddress\":{\"$ref\":\"centralus_252\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797252378081_7d932c7b-a6d3-4c4b-a6dd-1a1c56f6a6da\",\"name\":\"2516899797252378081_7d932c7b-a6d3-4c4b-a6dd-1a1c56f6a6da\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a suspicious IP\",\"alertName\":\"SIMULATED_AzureCosmosDB_SuspiciousIp\",\"detectedTimeUtc\":\"2024-04-05T12:44:34.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: Azure Cosmos DB account 'Sample-AzureCosmosDBAccount' was successfully accessed from an IP address that was identified as a threat by Microsoft Threat Intelligence.\\r\\nThe threat actor's access was authenticated using Aad.\",\"remediationSteps\":\"• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.\\r\\n• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.\\r\\n• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"fc4f9838-ac7a-2051-a277-c5ebb3783398\",\"extendedProperties\":{\"resourceType\":\"Azure Cosmos DB Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Verify whether this user is legitimate. Review the credentials used and user's history of actions on this resource and others.\\r\\n• Check for credential theft by reviewing the authentication method.\",\"potential causes\":\"• An attacker has accessed your Azure Cosmos DB account from a potentially suspicious IP.\\r\\n• A legitimate user has accessed your Azure Cosmos DB account from a potentially suspicious IP.\",\"user agent\":\"dummyAgent\",\"container name\":\"Sample-Container\",\"database name\":\"Sample-Database\",\"key type\":\"Aad\",\"connection mode\":\"Gateway\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.623Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_254\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_255\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"threatIntelligence\":[{\"providerName\":\"A Microsoft Partner\",\"threatType\":\"Eicar threat type\",\"threatName\":\"Eicar malware family\",\"confidence\":1.0,\"reportLink\":\"\",\"threatDescription\":\"Eicar description\"}],\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_256\",\"sourceAddress\":{\"$ref\":\"centralus_255\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797272378081_09a88bd4-006e-4e8f-88ad-bb3d091ac190\",\"name\":\"2516899797272378081_09a88bd4-006e-4e8f-88ad-bb3d091ac190\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] SQL injection: failed fuzzing attempt\",\"alertName\":\"SIMULATED_AzureCosmosDB_SqlInjection.Fuzzing\",\"detectedTimeUtc\":\"2024-04-05T12:44:32.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious SQL statement was used to query container 'Sample-Container' in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount'.\\r\\nLike other well-known SQL injection attacks, this statement won’t succeed in Azure Cosmos DB. Nevertheless, it’s an indication that a threat actor is trying to attack the resources in this account.\\r\\nSome SQL injection attacks can succeed and be used to exfiltrate data. This means that if the attacker continues performing SQL injection attempts, they may be able to compromise your Azure Cosmos DB account and exfiltrate data.\\r\\nYou can prevent this threat by using parameterized queries (for more information, see the remediation steps).\",\"remediationSteps\":\"• This alert may indicate this subscription is being targeted. To harden your environment, resolve any outstanding Defender for Cloud security recommendations for this resource and any others on this Azure subscription.\\r\\n• To prevent similar attacks in the future, use Azure Cosmos DB parameterized queries in all your apps.\\r\\nHow to use parameterized queries: https://go.microsoft.com/fwlink/?linkid=2177214.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"6deabc7f-59fa-88c6-fc0c-a67a2adbca8d\",\"extendedProperties\":{\"resourceType\":\"Azure Cosmos DB Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"client IP address\":\"00.00.00.00\",\"investigation steps\":\"• Verify whether this user is legitimate. Review the credentials used and user's history of actions on this resource and others.\\r\\n• Search for other alerts on this subscription that might indicate that this is part of a larger attack.\\r\\n• Inspect the application that is connected to this Azure Cosmos DB account. It may be vulnerable to this fuzzing attack.\",\"potential causes\":\"• Failed attack attempt, part of an enumeration, reconnaissance or command injection attempt.\\r\\n• Pen testing.\",\"user agent\":\"dummyAgent\",\"collection name\":\"Sample-Collection\",\"database name\":\"Sample-DataBase\",\"top suspicious queries\":\"• [1 rows returned] SELECT VALUE [{\\\"item\\\": COUNT(1)}]\\nFROM root\\nWHERE ((root[\\\"creation_datetime\\\"] = \\\"2022-07-06T00:00:00+00:00\\\") AND (root[\\\"camera_id\\\"] IN (\\\"javascript:alert(_SCAN-@126032-951533-1926@-);\\\")))\\nORDER BY root[\\\"order\\\"] ASC, root[\\\"_ts\\\"] ASC\\r\\n• [0 rows returned] SELECT root._rid, [{\\\"item\\\": root[\\\"order\\\"]}, {\\\"item\\\": root[\\\"_ts\\\"]}] AS orderByItems, root AS payload\\nFROM root\\nWHERE ((((root[\\\"creation_datetime\\\"] = \\\"2022-07-06T00:00:00+00:00\\\") AND (root[\\\"camera_id\\\"] IN (\\\"javascript:alert(_SCAN-@126032-951533-1926@-);\\\"))) AND (true)) AND IS_DEFINED(root))\\nORDER BY root[\\\"order\\\"] ASC, root[\\\"_ts\\\"] ASC\\nOFFSET 0 LIMIT 100\",\"total suspicious queries\":\"2\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.577Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_257\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_258\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_259\",\"sourceAddress\":{\"$ref\":\"centralus_258\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797292378081_6613a3da-831b-48e4-8f5e-98ccc96290a5\",\"name\":\"2516899797292378081_6613a3da-831b-48e4-8f5e-98ccc96290a5\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] SQL injection: potential data exfiltration\",\"alertName\":\"SIMULATED_AzureCosmosDB_SqlInjection.DataExfiltration\",\"detectedTimeUtc\":\"2024-04-05T12:44:30.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious SQL statement was used to query container 'Sample-Container' in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount'.\\r\\nThe injected statement might have succeeded in exfiltrating data the user wasn’t authorized to access.\\r\\nDue to the structure and capabilities of Azure Cosmos DB queries, many known SQL injection attacks on Azure Cosmos DB accounts cannot work. However, the variation used in this attack may work and threat actors can exfiltrate data.\",\"remediationSteps\":\"• To prevent similar attacks in the future, use Azure Cosmos DB parameterized queries in all your apps.\\r\\nHow to use parameterized queries: https://go.microsoft.com/fwlink/?linkid=2177214.\\r\\n• If, for some reason, you can’t use parameterized queries, perform another form of input validation to protect against SQL injection attacks.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"87a2b572-0206-725f-8999-1a57c0f2d116\",\"extendedProperties\":{\"resourceType\":\"Azure Cosmos DB Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Investigate the query and the user. For details of the user, review the audit logs of your application. Check which user ran the query.\\r\\n• If the action appears malicious, continue investigating the blast radius. You may run the query (shown in the field \\\"Top suspicious queries\\\") to see what data was exfiltrated.\",\"potential causes\":\"• Successful data exfiltration (True Positive).\\r\\n• Pen testing.\\r\\n• A legitimate actor is trying to see all of the data, bypassing the application's access control methods. In this case, this can be considered a False Positive, however this is unsafe and should be blocked (see remediation steps on blocking).\",\"user agent\":\"dummySqlAgent\",\"container name\":\"Sample-Container\",\"database name\":\"Sample-Database\",\"key type\":\"\",\"connection mode\":\"\",\"total anomalous queries\":\"1\",\"top anomalous queries\":\"• SELECT * FROM root WHERE (root[\\\\\\\"userId\\\\\\\"] = \\\\\\\"123' OR '1'='1'\\\\\\\")\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.525Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_260\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_261\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_262\",\"sourceAddress\":{\"$ref\":\"centralus_261\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797312378081_83144d98-bd3d-4c66-9083-9a0b7a36ac65\",\"name\":\"2516899797312378081_83144d98-bd3d-4c66-9083-9a0b7a36ac65\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from an unusual location\",\"alertName\":\"SIMULATED_AzureCosmosDB_GeoAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:28.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: One or more containers in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount' were accessed from a location considered unfamiliar, based on the usual access pattern.\\r\\nEither a threat actor has gained access to the account, or a legitimate user has connected from a new or unusual geographic location.\",\"remediationSteps\":\"• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.\\r\\n• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.\\r\\n• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"56e1b065-e166-d10e-7192-20a8600ebc85\",\"extendedProperties\":{\"resourceType\":\"Azure Cosmos DB Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Contact the user to validate whether this is known and expected activity.\",\"potential causes\":\"• An attacker has accessed your Azure Cosmos DB account.\\r\\n• A legitimate user has accessed your Azure Cosmos DB account from a new location.\",\"user agent\":\"dummyAgent\",\"container name\":\"Sample-Container\",\"database name\":\"Sample-Database\",\"key type\":\"Aad\",\"connection mode\":\"Gateway\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.478Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_263\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_264\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_265\",\"sourceAddress\":{\"$ref\":\"centralus_264\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797332378081_1af21669-0dd6-4965-9a76-35ab36bc6976\",\"name\":\"2516899797332378081_1af21669-0dd6-4965-9a76-35ab36bc6976\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusual volume of data extracted\",\"alertName\":\"SIMULATED_AzureCosmosDB_DataExfiltrationAnomaly\",\"detectedTimeUtc\":\"2024-04-05T12:44:26.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: An unusually large amount of data has been extracted from container 'Sample-Container' in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount'. This might indicate that a threat actor exfiltrated data.\",\"remediationSteps\":\"• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.\\r\\n• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.\\r\\n• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"d2177140-35ad-46c8-d15c-e49a72e2431b\",\"extendedProperties\":{\"resourceType\":\"Azure Cosmos DB Account\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Databases\",\"effectiveSubscriptionId\":\"subscription-id\",\"alert Id\":\"00000000-0000-0000-0000-000000000000\",\"investigation steps\":\"• Check whether this Azure Cosmos DB account holds sensitive data. Look at diagnostic logs for any sensitive data that may have leaked and escalate the alert and information. If it appears sensitive data may have leaked, immediately review access permissions to the account and consider rotating keys.\",\"potential causes\":\"• An attacker has extracted a large amount of data from an account.\\r\\n• A legitimate user or application has extracted an unusual amount of data from an account.\",\"collection name\":\"Sample-Collection\",\"database name\":\"Sample-DataBase\",\"key type\":\"Aad\",\"connection mode\":\"Gateway\",\"impacted region\":\"EUS\",\"extracted data\":\"5.37 GB\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.42Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_266\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_267\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_268\",\"sourceAddress\":{\"$ref\":\"centralus_267\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899797352378081_e52e6807-3ecf-4721-83b1-ea474490b400\",\"name\":\"2516899797352378081_e52e6807-3ecf-4721-83b1-ea474490b400\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Preview - Suspicious extraction of Azure Cosmos DB account keys was detected\",\"alertName\":\"SIMULATED_AzureCosmosDB_SuspiciousListKeys.SuspiciousPrincipal\",\"detectedTimeUtc\":\"2024-04-05T12:44:24.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious source extracted Azure Cosmos DB account access keys from your subscription. If this source is not a legitimate source, this may be a high impact issue. The access key that was extracted provides full control over the associated databases and the data stored within.\\r\\nThe key extraction is suspicious for the following reasons:\\r\\n- Key listing operations are rarely invoked by this principal on Azure Cosmos DB accounts in this subscription.\\r\\n\\r\\nThis can indicate that the identity performed this operation is compromised and is being used with malicious intent.\",\"remediationSteps\":\"• Determine whether the activity was intentional by contacting the account owner. If the activity was intentional and legitimate, dismiss the alert. Otherwise, treat the user account, involved Azure Cosmos DB accounts and Azure subscription as compromised and continue with the next remediation steps.\\r\\n• Remediate the compromised principal account : delete the account if it’s an unfamiliar account (the attacker may have created it). Otherwise, change its authentication credentials, use Azure Activity Logs to locate suspicious activities and review all activities performed by the user.\\r\\n• Remediate the compromised Azure Cosmos DB account: rotate Azure Cosmos DB account keys that were previously listed by the threat actor.\\r\\n• Remediate the compromised subscription: review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources and delete any unfamiliar Azure Resource, review all alerts in the Microsoft Defender for Cloud portal to the subscription and investigate them, use Azure Activity Logs to locate any suspicious activities and review all activities that were performed in this subscription.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c55e8a19-b167-c04e-2d62-1bc2e7f389a4\",\"extendedProperties\":{\"resourceType\":\"Resource Group\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Other\",\"effectiveSubscriptionId\":\"subscription-id\",\"principal object ID\":\"00000000-0000-0000-0000-000000000000\",\"source IP address\":\"00.00.00.00\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.717Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_269\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_270\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"threatIntelligence\":[{\"providerName\":\"A Microsoft Partner\",\"threatType\":\"Eicar threat type\",\"threatName\":\"Eicar malware family\",\"confidence\":1.0,\"reportLink\":\"\",\"threatDescription\":\"Eicar description\"}],\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_271\",\"sourceAddress\":{\"$ref\":\"centralus_270\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/providers/Microsoft.Security/locations/centralus/alerts/2516899797372378081_d1df8c84-88f7-4909-957e-b2043ec2bd48\",\"name\":\"2516899797372378081_d1df8c84-88f7-4909-957e-b2043ec2bd48\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Extraction of Azure Cosmos DB accounts keys via a potentially malicious script\",\"alertName\":\"SIMULATED_AzureCosmosDB_SuspiciousListKeys.MaliciousScript\",\"detectedTimeUtc\":\"2024-04-05T12:44:22.7621918Z\",\"description\":\"THIS IS A SAMPLE ALERT: A Powershell script was run in your subscription and performed a suspicious pattern of key-listing operations to get the keys of Azure Cosmos DB accounts in your subscription.\\r\\nThreat actors use automated scripts, like Microburst, to list keys and find Azure Cosmos DB accounts they can access.\\r\\n\\r\\nThis operation might indicate that an identity in your organization was breached, and that the threat actor is trying to compromise Azure Cosmos DB accounts in your environment for malicious intentions.\\r\\nAlternatively, a malicious insider could be trying to access sensitive data and perform lateral movement.\",\"remediationSteps\":\"• Remediate the compromised user identity: If it’s an unfamiliar, new identity (the threat actor may have created it), then delete the user identity.\\r\\nOtherwise, change the user’s authentication credentials, use Azure Activity Logs to locate suspicious activities and review all activities performed by the user.\\r\\n• Remediate the compromised Azure Cosmos DB account: rotate Azure Cosmos DB accounts keys that were previously listed by the threat actor.\\r\\n• Remediate the compromised subscription: review IAM permissions for the subscription and remove permissions for any unfamiliar user identity.\\r\\nReview all Azure resources and delete any unfamiliar Azure resources.\\r\\nReview all alerts in Microsoft Defender for Cloud related to the subscription and investigate them.\\r\\nUse Azure Activity Logs to find suspicious activities and review all activities performed in this subscription.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"associatedResource\":\"/subscriptions/subscription-id\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"cc007c81-7be7-e404-7813-2436459feea3\",\"extendedProperties\":{\"resourceType\":\"Subscription\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id\",\"compromisedEntity\":\"Sample-AzureCosmosDb\",\"productComponentName\":\"Resource Manager\",\"effectiveSubscriptionId\":\"subscription-id\",\"investigation steps\":\"Investigate whether the identity that performed the list-key operations is compromised:\\r\\n• Contact the Azure Cosmos DB account owner to understand their intentions and actions.\\r\\n• Look at the authentication method of this user and the actions they performed across the Azure subscription.\\r\\nUse Azure Activity Logs to locate suspicious activities and review all activities performed by the user.\\r\\n• If you have diagnostic logs enabled, inspect the actions this identity performed in the Azure Cosmos DB account/s.\",\"username\":\"Sample-Username\",\"ip address\":\"00.00.00.00\",\"aad user ID\":\"00000000-0000-0000-0000-000000000000\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.67Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_272\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount\",\"resourceType\":\"Azure Cosmos DB Account\",\"resourceName\":\"Sample-AzureCosmosDBAccount\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_273\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"Virginia\",\"city\":\"Washington\",\"longitude\":-78.17197,\"latitude\":38.73078,\"asn\":8075},\"threatIntelligence\":[{\"providerName\":\"A Microsoft Partner\",\"threatType\":\"Eicar threat type\",\"threatName\":\"Eicar malware family\",\"confidence\":1.0,\"reportLink\":\"\",\"threatDescription\":\"Eicar description\"}],\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_274\",\"sourceAddress\":{\"$ref\":\"centralus_273\"},\"protocol\":\"Tcp\",\"friendlyName\":\"00.00.00.00\",\"asset\":false,\"type\":\"network-connection\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_103a8e40-3011-4b01-b458-49c9a389d575\",\"name\":\"2516899831572222488_103a8e40-3011-4b01-b458-49c9a389d575\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] API requests spray from a single IP address to an unusually large number of distinct API endpoints\",\"alertName\":\"SIMULATED_API_SprayInRequests\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A single IP was observed making API calls to an unusually large number of distinct endpoints. Based on historical traffic patterns from the last 30 days, Defenders for APIs learns a baseline that represents the typical number of distinct endpoints called by a single IP across 20-minute windows. The alert was triggered because a single IP's behavior deviated significantly from the historical baseline.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Check that the IP responsible for the suspicious call is benign and has a valid business reason for accessing the endpoints.\\n2. Evaluate any other alerts against this IP or targeted endpoints to help contextualize the event.\\n3. Check the returned status code for the API call. 2XX indicates success. 3XX indicates redirection. 4XX indicates client errors. 5XX indicates server errors. A \\\"spray\\\" of API requests with 4XX and 5XX status codes are particularly suspicious.\\n4. If this behavior is determined to be malicious, you may want to block or limit the IP. If the targeted endpoints are intended to be accessed by only a few IPs, consider implementing policies or rules that allow only specific IPs to access the endpoint.\\n\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"9dc8f904-1dfb-c8e5-4821-9d49170206c6\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"Each IP has a unique business context for interacting with APIs. If an IP is observed accessing an unusually large number of distinct endpoints, this marks a deviation from the historical business routine. This event may indicate a case of compromised credentials or attacker reconnaissance. An attacker may have \\\"sprayed\\\" requests as a part of reconnaissance activities and gathered insights based on response content and status codes.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"actor (Client IP)\":\"00.00.00.00\",\"event of Interest (Spike)\":\"IP 00.00.00.00 called 54 (distinct) of your API endpoints in a 20 minute time window.\",\"historical Behavior\":\"In the past 30 days, IP 00.00.00.00 called an average (mean) of 1.04 distinct API endpoints across 20 minute time windows. Across 20 minute periods, the standard deviation for the number of distinct API endpoints called was 0.2.\",\"deviation from Historical Behavior\":\"The event of interest (Calls to 54 distinct API endpoints) is several standard deviations higher than the observed mean.\",\"distinct Endpoints Called in 20 minutes\":\"54\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.952Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_275\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_276\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_120be262-3637-40c8-b797-c7e84ebfc2fa\",\"name\":\"2516899831572222488_120be262-3637-40c8-b797-c7e84ebfc2fa\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious User Agent detected\",\"alertName\":\"SIMULATED_API_AccessFromSuspiciousUserAgent\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: The user agent of a request accessing one of your API endpoints contained anomalous values indicative of an attempt at remote code execution. This does not mean that any of your API endpoints have been breached, but it does suggest that an attempted attack is underway.\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources this user might be trying to access.\\n2. Ensure that these resources are still protected and/or operating as expected.\\n3. Check the Client IP making the suspicious call and evaluate other alerts against this user to contextualize the event.\\n4. Consider adding IP-blocking rules against the Client IP.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"75e7b542-4771-97e8-e1ab-9fce290df305\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker who is attempting to probe your API for vulnerabilities. The attacker may be seeking access to confidential data on your system, or they might be aiming to take over your system as a springboard for further attacks. Be on the lookout for any questionable activity to this endpoint or originating from this same IP.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"User agent sample-agent contains distinct patterns typical of script code and atypical of legitimate user agents\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"200\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.291Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_277\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_278\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_239476e9-2a4d-4bc3-91e4-2b011da24518\",\"name\":\"2516899831572222488_239476e9-2a4d-4bc3-91e4-2b011da24518\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Unusually large response payload transmitted between a single IP address and an API endpoint\",\"alertName\":\"SIMULATED_API_SpikeInPayload\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious spike in API response payload size was observed for traffic between a single IP and one of the API endpoints. Based on historical traffic patterns from the last 30 days, Defender for APIs learns a baseline that represents the typical API response payload size between a specific IP and API endpoint. The learned baseline is specific to API traffic for each status code (e.g., 200 Success). The alert was triggered because an API response payload size deviated significantly from the historical baseline. \\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Check that the IP responsible for the suspicious call is benign and has a valid business reason for accessing the endpoint.\\n2. Consider any external events that could explain the large payload size.\\n3. Evaluate any other alerts against this IP or endpoint to help contextualize the spike in payload size.\\n4. Inspect the contents of the API call to ensure that malicious contents are not being injected and that data is not being exfiltrated.\\n5. Check the returned status code for the API call. 2XX indicates success. 3XX indicates redirection. 4XX indicates client errors. 5XX indicates server errors. Large payload API calls with 4XX and 5XX status codes are particularly suspicious.\\n6. If this API call is determined to be malicious, you may want to block or limit the IP. If the endpoint is intended to be accessed by only a few IPs, consider implementing policies or rules that allow only specific IPs to access the endpoint.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"0a12cb04-9a14-1205-a425-45ef12ae51aa\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may be a result of an injection attack or an attempt to exfiltrate large amounts of data.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"200\",\"event of Interest (Spike)\":\"Client IP 00.00.00.00 recently made an API call (status code 200) with payload size (1255.7 KB) to GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation.\",\"historical Behavior\":\"In the past 30 days, IP 00.00.00.00 made API calls (with status code 200) with an average (mean) payload size of 110.0 KB to GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation. Across API calls, the standard deviation for payload size was 7.39 KB\",\"deviation from Historical Behavior\":\"The event of interest (API Payload Size 1255.7 KB) is several standard deviations higher than the observed mean.\",\"payload Size (KB)\":\"1255.7\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.369Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_279\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_280\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_281\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_4439a818-8cc3-4970-bf1b-7356cc839d07\",\"name\":\"2516899831572222488_4439a818-8cc3-4970-bf1b-7356cc839d07\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious population-level spike in API traffic to an API endpoint\",\"alertName\":\"SIMULATED_API_PopulationSpikeInAPITraffic\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious spike in API traffic was detected at one of the API endpoints. The detection system used historical traffic patterns to establish a baseline for routine API traffic volume between all IPs and the endpoint, with the baseline being specific to API traffic for each status code (such as 200 Success). The detection system flagged an unusual deviation from this baseline leading to the detection of suspicious activity.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Consider population level traffic to the endpoint. Are there external events (such as the Holiday season) that could be causing a surge in API traffic to this endpoint?\\n2. Evaluate any other alerts against the endpoint or the involved IPs to help contextualize this spike in traffic\\n3. Check the returned status code for the API calls that make up the spike. 2XX indicates success. 3XX indicates redirection. 4XX indicates client errors. 5XX indicates server errors. Spikes with 4XX and 5XX status codes are particularly suspicious.\\n4. If this spike in traffic is determined to be malicious, you may want to block or limit malicious IPs contributing to the spike. It is also recommended that rate-limiting is implemented across your APIs during development. If the endpoint is intended to be accessed by only a few IPs, consider implementing policies or rules that allow only specific IPs to access the endpoint.\\n\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"021f9468-f874-9c16-f244-928a860ccd35\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This represents a \\\"spike\\\" in API traffic that may indicate an attack. This event may be caused by distributed attacks such as distributed denial of service, password brute-force and credential stuffing.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"200\",\"event of Interest (Spike)\":\"The aggregate user population (all IPs) made 2694 API calls to GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation with status code 200 in a 20 minute time window.\",\"historical Behavior\":\"In the past 30 days, the aggregate user population (all IPs) made an average (mean) of 1196.95 API calls to GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation with a status code of 200 across 20 minute time windows. Across 20 minute periods, the standard deviation for the number of API calls was 255.38.\",\"deviation from Historical Behavior\":\"The event of interest (2694 API calls with status code 200) is several standard deviations higher than the observed mean.\",\"spike (Number of API calls in 20 minutes)\":\"2694\",\"actor\":\"Aggregate User Population (All IPs)\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.811Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_282\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_283\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_455a689f-a8aa-4ac3-b662-dacdaffea3f8\",\"name\":\"2516899831572222488_455a689f-a8aa-4ac3-b662-dacdaffea3f8\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Access from a Tor exit node to an API endpoint\",\"alertName\":\"SIMULATED_API_AccessFromTorExitNode\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: An IP address from the Tor network accessed one of your API endpoints. Tor is a network that allows people to access the Internet while keeping their real IP hidden. Though there are legitimate uses, it is frequently used by attackers to hide their identity when they target people's systems online.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources this user might be trying to access.\\n2. Check the Client IP making the suspicious call and evaluate other alerts against this user to contextualize the event.\\n3. Consider adding IP-blocking rules against the Tor network (unless you expect Tor users to access your API).\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"f8e95cd2-6c9d-6e10-440d-1680b81f7824\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker who is attempting to probe your API for vulnerabilities. The attacker may be seeking access to confidential data on your system, or they might be aiming to take over your system as a springboard for further attacks. Due to the transient nature of IP addresses, it is also possible that this traffic is innocuous, but be on the lookout for any questionable activity originating from this IP.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"Client IP 00.00.00.00 has been identified as part of the Tor network, an IP anonymizer service commonly used for attacks\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"401\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.197Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_284\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_285\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_512bb9fa-df70-4ce2-9a78-212418dafe69\",\"name\":\"2516899831572222488_512bb9fa-df70-4ce2-9a78-212418dafe69\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Distributed parameter enumeration on an API endpoint\",\"alertName\":\"SIMULATED_API_DistributedParameterEnumeration\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: The aggregate user population (all IPs) was observed enumerating parameters when accessing one of the API endpoints. Based on historical traffic patterns from the last 30 days, Defender for APIs learns a baseline that represents the typical number of distinct parameter values used by the user population (all IPs) when accessing an endpoint across 20-minute windows. The alert was triggered because the user population recently accessed an endpoint using an unusually large number of distinct parameter values.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources a user can access by manipulating the parameter of interest and evaluate the sensitivity of such resources.\\n2. Check that proper authentication controls are implemented for this endpoint. Authentication should be implemented at the resource level, not just the endpoint level.\\n3.  Implement authentication at the resource level to prevent future exploits resulting from broken object level authorization (BOLA).\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"490efe61-5d02-d85d-05b6-b5789abd59e3\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker exploiting broken object level authorization (BOLA)  on your endpoint. If this endpoint does not have proper authentication controls  at the object/resource level,  an attacker can access sensitive user or resource data by enumerating API parameter values.\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"The aggregate user population (all IPs) recently called GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation and used an average 102.0 distinct values for paramter \\\"sample-api-operation\\\" across several requests in a 20 minute time-window\",\"actor (Client IP)\":\"Aggregate User Population (All IPs)\",\"api Endpoint\":\"/sample-api-collection/sample-api-operation/sample-parameter\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"historical Behavior\":\"In the past 30 days, the aggregate user population (all IPs) called GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation and used an average (mean) of 1.27 distinct values for parameter \\\"sample-api-operation\\\" across 20 minute time windows. Across 20 minute periods, the standard deviation for the distinct number of values used for parameter \\\"sample-api-operation\\\" was 2.37.\",\"deviation from Historical Behavior\":\"The event of interest (API calls using 102.0 distinct values for parameter \\\"sample-api-operation\\\") is several standard deviations higher than the observed mean.\",\"parameter of Interest\":\"sample-api-operation\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.041Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_286\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_aaeb10aa-d768-48a6-a3ad-9941fd6b14a3\",\"name\":\"2516899831572222488_aaeb10aa-d768-48a6-a3ad-9941fd6b14a3\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Previously unseen parameter used in an API call\",\"alertName\":\"SIMULATED_API_UnseenParam\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A single IP was observed accessing one of the API endpoints using a previously unseen or out-of-bounds parameter in the request. Based on historical traffic patterns from the last 30 days, Defender for APIs learns a set of expected parameters associated with calls to an endpoint The alert was triggered because an IP recently accessed an endpoint using a previously unseen parameter.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources a user might be trying to access by manipulating the parameter of interest.\\n2. Check the Client IP making the suspicious call and evaluate other alerts against this user to contextualize the event\\n3. Check your API specification to see if there are expected parameters defined for this endpoint\\n4. If there are currently no resource limiting rules, implement parameterrestrictions for each endpoint and update your API specification to reflect the changes\\n\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"71c22801-a0d5-dcd9-651b-8e90f0c30599\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker who is manipulating parameters and does not understand the business context of your API. The attacker may be engaging in reconnaissance by sending requests to your endpoint and gleaning information from responses. These requests may have been carefully crafted with specific parameters intended to access resources or extract data. Additionally, this event may signal an exploit of lack of resource limiting and broken function level authorization.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"Client IP 00.00.00.00 recently called GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation and used a previously unseen parameter \\\"\\\"sample-new-parameter\\\"\\\".\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"200\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"historical Behavior\":\"Based on historical activity from users accessing GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation in the past 30 days, GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation is expected to take parameters \\\"\\\"parameter1\\\", \\\"parameter2\\\", \\\"parameter3\\\", \\\"parameter4\\\", \\\"parameter5\\\"\\\"\",\"deviation from Historical Behavior\":\"\\\"\\\"sample-new-parameter\\\"\\\" is an unexpected parameter for this endpoint that may not be valid\\t\",\"parameter of Interest\":\"\\\"sample-new-parameter\\\"\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.155Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_287\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_288\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_289\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_ae23a056-c9f4-44cb-86aa-ac8e0e420cc7\",\"name\":\"2516899831572222488_ae23a056-c9f4-44cb-86aa-ac8e0e420cc7\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious spike in latency for traffic between a single IP address and an API endpoint\",\"alertName\":\"SIMULATED_API_SpikeInLatency\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious spike in latency was observed for traffic between a single IP and one of the API endpoints. Based on historical traffic patterns from the last 30 days, Defender for APIs learns a baseline that represents the routine API traffic latency between a specific IP and API endpoint. The learned baseline is specific to API traffic for each status code (e.g., 200 Success). The alert was triggered because an API call latency deviated significantly from the historical baseline.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Check that the IP responsible for the high latency call is benign and has a valid business reason for accessing the endpoint\\n2. Consider any external events that that could explain an increase in latency\\n3. Evaluate any other alerts against this IP or endpoint to help contextualize the spike in latency\\n4. Check the returned status code for the API call. 2XX indicates success. 3XX indicates redirection. 4XX indicates client errors. 5XX indicates server errors. High latency API calls with 4XX and 5XX status codes are particularly suspicious\\n5. If this API call is determined to be malicious, you may want to block or limit the IP. If the endpoint is intended to be accessed by only a few IPs, consider implementing policies or rules that allow only specific IPs to access the endpoint.\\n\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"3bdb5834-9876-40b2-d0c3-ff17d7586d87\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may be a result of an injection attack or an attempt to exfiltrate large amounts of data.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"200\",\"event of Interest (Spike)\":\"Client IP 00.00.00.00 recently made an API call (status code 200)  with latency (31046.92ms) to GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation.\",\"historical Behavior\":\"In the past 30 days, distinct IPs accessing GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation made API calls (with status code 200) with an average (mean) latency of 37.51ms to this endpoint. Across API calls, the standard deviation for latency was 1481.59ms.\",\"deviation from Historical Behavior\":\"The event of interest (API Latency of 31046.92ms) is several standard deviations higher than the observed mean for individual users accessing this endpoint.\",\"latency (ms)\":\"31046.92\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.9Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_290\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_291\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_292\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_be7edaac-9793-4c6b-870b-dab79dfc439a\",\"name\":\"2516899831572222488_be7edaac-9793-4c6b-870b-dab79dfc439a\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Parameter enumeration on an API endpoint\",\"alertName\":\"SIMULATED_API_ParameterEnumeration\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: The aggregate user population (all IPs) was observed enumerating parameters when accessing one of the API endpoints. Based on historical traffic patterns from the last 30 days, Defender for APIs learns a baseline that represents the typical number of distinct parameter values used by the user population (all IPs) when accessing an endpoint across 20-minute windows. The alert was triggered because the user population recently accessed an endpoint using an unusually large number of distinct parameter values.  \\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources a user can access by manipulating the parameter of interest and evaluate the sensitivity of such resources.\\n2. Check that proper authorization controls are implemented for this endpoint. Authorization should be implemented at the resource level, not just the endpoint level.\\n3.  Implement authorization at the resource level to prevent future exploits resulting from broken object level authorization (BOLA).\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"03f97d50-6f18-4b20-9604-036bb652ba4b\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker exploiting broken object level authorization (BOLA) on your endpoint. If this endpoint does not have proper authorization controls at the object/resource level,  an attacker can access sensitive user or resource data by enumerating API parameter values.\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"The aggregate user population (all IPs) recently called GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation/userID and used an average 219.0 distinct values for parameter \\\"userID\\\" across several requests in a 20 minute time-window\",\"actor (Client IP)\":\"Aggregate User Population (All IPs)\",\"api Endpoint\":\"/sample-api-collection/sample-api-operation/sample-parameter\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation/userID\",\"historical Behavior\":\"In the past 30 days, the aggregate user population (all IPs) called GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation and used an average (mean) of 1.29 distinct values for parameter \\\"userID\\\" across 20 minute time windows. Across 20 minute periods, the standard deviation for the distinct number of values used for parameter \\\"userID\\\" was 4.55.\",\"deviation from Historical Behavior\":\"The event of interest (API calls using 219.0 distinct values for parameter \\\"sample-api-operation\\\") is several standard deviations higher than the observed mean.\",\"parameter of Interest\":\"userID\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.999Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_293\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_294\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_bf186827-734f-4443-8680-2919d367be0d\",\"name\":\"2516899831572222488_bf186827-734f-4443-8680-2919d367be0d\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Parameter value(s) with anomalous data types in an API call\",\"alertName\":\"SIMULATED_API_UnseenParamType\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A single IP was observed accessing one of your API endpoints and using parameter values of a low probability data type (e.g., string, integer, etc.). Based on historical traffic patterns from the last 30 days, Defender for APIs learns the expected data types for each API parameter. The alert was triggered because an IP recently accessed an endpoint using a previously low probability data type as a parameter input.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources a user can access by manipulating the parameter of interest and evaluate the sensitivity of such resources.\\n2. Check the Client IP making the suspicious call and evaluate other alerts\\n against this user to contextualize the event.\\n3. Check your API specification to see if there are expected data types defined for this parameter.\\n4. If there are currently no resource limiting rules, implement data typerestrictions for each parameter and update your API specification to reflect the changes.\\n\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"c0c3364f-4f36-0f8e-96aa-e21cbb5d5bc4\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker who is manipulating parameters and does not understand the business context of your API. The attacker may be engaging in reconnaissance by sending requests to your endpoint and gleaning information from responses. These requests may have been carefully crafted with specific parameters intended to access resources or extract data. Additionally, this event may signal an exploit of lack of resource limiting and broken function level authorization.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"Client IP 00.00.00.00 recently called GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation  and used the following parameters and types:\\n\\nQuery string parameters and types:\\nname: STRING\\nssample-query-parameter: STRING\\n\\nThe following parameters were highly anomalous:\\n\\nQuery string anomalous parameters:\\nsample-query-parameter\\n\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"400\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation?sample-query-parameter=sample-query-value\",\"historical Behavior\":\"Based on historical activity from users accessing GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation in the past 30 days, the highly anomalous parameters had the following historical type percentages:\\n\\nAnomalous Query String Parameters History:\\nsample-query-parameter:\\nNUMBER: 0.0%\\nBOOLEAN: 100.0%\\nDATE_TIME: 0.0%\\nSTRING: 0.0%\\nEMPTY: 0.0%\\n\\n\\n\",\"deviation from Historical Behavior\":\"The following parameter(s) had a value passed in that was deemed anomalous based on the historical data for the API endpoint:\\n\\nQuery string anomalous parameters:\\nsample-query-parameter\\n\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.108Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_295\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_296\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_297\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_ddfeb49f-527b-471a-ba75-411d1f43a190\",\"name\":\"2516899831572222488_ddfeb49f-527b-471a-ba75-411d1f43a190\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] Suspicious spike in API traffic from a single IP address to an API endpoint\",\"alertName\":\"SIMULATED_API_SpikeInAPITraffic\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: A suspicious spike in API traffic was detected from a client IP to the API endpoint. The detection system used historical traffic patterns to establish a baseline for routine API traffic volume to the endpoint coming from a specific IP to the endpoint. The detection system flagged an unusual deviation from this baseline leading to the detection of suspicious activity.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Consider population level traffic to the endpoint. Are there external events (such as the Holiday season) that could be causing a surge in API traffic to this endpoint?\\n2. Evaluate any other alerts against the endpoint or the involved IPs to help contextualize this spike in traffic\\n3. Check the returned status code for the API calls that make up the spike. 2XX indicates success. 3XX indicates redirection. 4XX indicates client errors. 5XX indicates server errors. Spikes with 4XX and 5XX status codes are particularly suspicious.\\n4. If this spike in traffic is determined to be malicious, you may want to block or limit malicious IPs contributing to the spike. It is also recommended that rate-limiting is implemented across your APIs during development. If the endpoint is intended to be accessed by only a few IPs, consider implementing policies or rules that allow only specific IPs to access the endpoint.\\n\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"Medium\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"5644d215-6ee7-72f0-2aac-6c7c9add0411\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This represents a \\\"spike\\\" in API traffic that may indicate an attack. This event may be caused by attacks such as denial of service, password brute-force and credential stuffing.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"POST https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"202\",\"event of Interest (Spike)\":\"Client IP 00.00.00.00 recently made 640 API calls to POST https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation with status code 202 in a 20 minute time window.\",\"historical Behavior\":\"In the past 30 days, distinct IPs accessing POST https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation made an average (mean) of 4.66 API calls to this endpoint with a status code of 202 across 20 minute time windows.\",\"deviation from Historical Behavior\":\"The event of interest (640 API calls with status code 202) is several multiples higher than the observed mean for individual users accessing this endpoint.\",\"spike (Number of API calls in 20 minutes)\":\"640\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:26.853Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_298\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_299\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-APIM\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"},{\"$id\":\"centralus_300\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"asset\":false,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}},{\"id\":\"/subscriptions/subscription-id/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2516899831572222488_e28b5132-b0f2-4b86-af50-c2692c206b11\",\"name\":\"2516899831572222488_e28b5132-b0f2-4b86-af50-c2692c206b11\",\"type\":\"Microsoft.Security/Locations/alerts\",\"properties\":{\"vendorName\":\"Microsoft\",\"alertDisplayName\":\"[SAMPLE ALERT] API Endpoint access from suspicious IP\",\"alertName\":\"SIMULATED_API_AccessFromSuspiciousIP\",\"detectedTimeUtc\":\"2024-04-05T11:47:22.7777511Z\",\"description\":\"THIS IS A SAMPLE ALERT: An IP address accessing one of your API endpoints was identified by Microsoft Threat Intelligence as having high-probability of being a threat. While observing malicious Internet traffic, this IP came up as involved in attacking online targets.\\n\\n\",\"remediationSteps\":\"To investigate and mitigate this potential breach, please follow the steps below.\\n\\n1. Inspect which resources this user might be trying to access.\\n2. Check the Client IP making the suspicious call and evaluate other alerts against this user to contextualize the event.\\n3. Consider adding IP-blocking rules against this client IP.\",\"actionTaken\":\"Undefined\",\"reportedSeverity\":\"High\",\"compromisedEntity\":\"Sample_API\",\"associatedResource\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"subscriptionId\":\"subscription-id\",\"instanceId\":\"929db718-4a75-e03e-9802-f03954767263\",\"extendedProperties\":{\"resourceType\":\"API Management Service\",\"effectiveAzureResourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"compromisedEntity\":\"Sample_API\",\"productComponentName\":\"APIs\",\"effectiveSubscriptionId\":\"subscription-id\",\"potential causes\":\"This event may represent an attacker who is attempting to probe your API for vulnerabilities. The attacker may be seeking access to confidential data on your system, or they might be aiming to take over your system as a springboard for further attacks. Due to the transient nature of IP addresses, it is also possible that this traffic is innocuous, but be on the lookout for any questionable activity originating from this IP.\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM\",\"subscriptionId\":\"00000000-0000-0000-0000-000000000000\",\"event of Interest\":\"Client IP 00.00.00.00 has been identified as having a high-probability of being involved in malicious activity\",\"actor (Client IP)\":\"00.00.00.00\",\"api Endpoint\":\"GET https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\",\"status Code\":\"404\",\"url\":\"https://sample-apim.sample-api.io/sample-api-collection/sample-api-operation\"},\"state\":\"Active\",\"reportedTimeUtc\":\"2024-04-05T12:47:27.244Z\",\"confidenceReasons\":[],\"canBeInvestigated\":true,\"isIncident\":false,\"entities\":[{\"$id\":\"centralus_301\",\"address\":\"00.00.00.00\",\"location\":{\"countryCode\":\"US\",\"countryName\":\"United States\",\"state\":\"California\",\"city\":\"San Jose\",\"longitude\":0.0,\"latitude\":0.0,\"asn\":0,\"carrier\":\"Microsoft Corporation\",\"organization\":\"Microsoft Corporation\"},\"asset\":false,\"type\":\"ip\"},{\"$id\":\"centralus_302\",\"resourceId\":\"/subscriptions/subscription-id/resourcegroups/Sample-RG/providers/Microsoft.ApiManagement/service/Sample-APIM/apis/Sample-API-Collection/operations/Sample-API-Operation\",\"resourceType\":\"API Management Service\",\"resourceName\":\"Sample-API-Operation\",\"metadata\":{\"isGraphCenter\":true},\"asset\":true,\"type\":\"azure-resource\"}],\"correlationKey\":\"\"}}]}"
          },
          "cookies": [],
          "headers": [
            {
              "name": "cache-control",
              "value": "no-cache"
            },
            {
              "name": "pragma",
              "value": "no-cache"
            },
            {
              "name": "content-length",
              "value": "335431"
            },
            {
              "name": "content-type",
              "value": "application/json; charset=utf-8"
            },
            {
              "name": "expires",
              "value": "-1"
            },
            {
              "name": "x-ms-original-request-ids",
              "value": ", "
            },
            {
              "name": "x-ms-ratelimit-remaining-subscription-resource-requests",
              "value": "749"
            },
            {
              "name": "x-ms-request-id",
              "value": "3c5e33b3-50c8-4005-bdfa-6600284798a9"
            },
            {
              "name": "x-ms-correlation-request-id",
              "value": "3c5e33b3-50c8-4005-bdfa-6600284798a9"
            },
            {
              "name": "x-ms-routing-request-id",
              "value": "BRAZILSOUTH:20240405T173548Z:3c5e33b3-50c8-4005-bdfa-6600284798a9"
            },
            {
              "name": "strict-transport-security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "name": "x-content-type-options",
              "value": "nosniff"
            },
            {
              "name": "x-cache",
              "value": "CONFIG_NOCACHE"
            },
            {
              "name": "x-msedge-ref",
              "value": "Ref A: E3B0C8C8BD3E426C867DA921CDF97350 Ref B: RIO201060612023 Ref C: 2024-04-05T17:35:47Z"
            },
            {
              "name": "date",
              "value": "Fri, 05 Apr 2024 17:35:47 GMT"
            },
            {
              "name": "connection",
              "value": "close"
            }
          ],
          "headersSize": 720,
          "httpVersion": "HTTP/1.1",
          "redirectURL": "",
          "status": 200,
          "statusText": "OK"
        },
        "startedDateTime": "2024-04-05T17:35:47.423Z",
        "time": 1473,
        "timings": {
          "blocked": -1,
          "connect": -1,
          "dns": -1,
          "receive": 0,
          "send": 0,
          "ssl": -1,
          "wait": 1473
        }
      }
    ],
    "pages": [],
    "version": "1.2"
  }
}
